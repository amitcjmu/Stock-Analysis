# Redis Production Environment Variables Template
# Generated by CC DevSecOps Engineer
#
# CRITICAL SECURITY NOTICE:
# - Replace all placeholder values with actual secure values
# - Use your organization's secret management system
# - NEVER commit actual passwords to version control
# - Generate passwords with minimum 32 characters
# - Use different passwords for each environment

# =====================================
# REDIS AUTHENTICATION CONFIGURATION
# =====================================

# Primary Redis instance authentication
# Use: openssl rand -base64 32
REDIS_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD

# Service-specific user passwords (each should be unique)
REDIS_APP_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD
REDIS_ADMIN_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD
REDIS_CACHE_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD
REDIS_FLOW_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD
REDIS_SSE_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD
REDIS_MONITOR_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD
REDIS_BACKUP_PASSWORD=REPLACE_WITH_SECURE_32_CHAR_PASSWORD

# =====================================
# NETWORK AND CONNECTION CONFIGURATION
# =====================================

# Redis connection settings
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=rediss://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Connection pool settings
REDIS_MAX_CONNECTIONS=100
REDIS_CONNECTION_TIMEOUT=10
REDIS_SOCKET_TIMEOUT=10
REDIS_SOCKET_KEEPALIVE=true
REDIS_RETRY_ON_TIMEOUT=true
REDIS_HEALTH_CHECK_INTERVAL=30

# =====================================
# TLS/SSL CONFIGURATION
# =====================================

# TLS enablement (REQUIRED for production)
REDIS_TLS_ENABLED=true
REDIS_TLS_PORT=6379

# TLS certificate paths (inside container)
REDIS_TLS_CERT_FILE=/certs/redis-server.crt
REDIS_TLS_KEY_FILE=/certs/redis-server.key
REDIS_TLS_CA_FILE=/certs/redis-ca.crt
REDIS_TLS_CLIENT_CERT_FILE=/certs/redis-client.crt
REDIS_TLS_CLIENT_KEY_FILE=/certs/redis-client.key

# TLS security settings
REDIS_TLS_PROTOCOLS=TLSv1.2,TLSv1.3
REDIS_TLS_AUTH_CLIENTS=true
REDIS_TLS_SESSION_CACHING=false

# Private key password (if certificates are password protected)
REDIS_TLS_KEY_PASSWORD=REPLACE_WITH_CERTIFICATE_PASSWORD_IF_USED

# =====================================
# MEMORY AND PERFORMANCE CONFIGURATION
# =====================================

# Memory management
REDIS_MAX_MEMORY=1gb
REDIS_MEMORY_POLICY=allkeys-lru

# Connection limits
REDIS_MAX_CLIENTS=1000
REDIS_TIMEOUT=300
REDIS_TCP_KEEPALIVE=300
REDIS_TCP_BACKLOG=511

# Performance tuning
REDIS_HZ=10
REDIS_DYNAMIC_HZ=true
REDIS_ACTIVE_REHASHING=true

# =====================================
# PERSISTENCE AND BACKUP CONFIGURATION
# =====================================

# Persistence settings
REDIS_AOF_ENABLED=true
REDIS_RDB_ENABLED=true
REDIS_DATA_DIR=/data

# RDB snapshot configuration
REDIS_RDB_SAVE_900=1
REDIS_RDB_SAVE_300=10
REDIS_RDB_SAVE_60=10000
REDIS_RDB_COMPRESSION=true
REDIS_RDB_CHECKSUM=true

# AOF configuration
REDIS_AOF_FILENAME=appendonly.aof
REDIS_AOF_FSYNC=everysec
REDIS_AOF_REWRITE_PERCENTAGE=100
REDIS_AOF_REWRITE_MIN_SIZE=64mb

# Backup configuration
REDIS_BACKUP_ENABLED=true
REDIS_BACKUP_ENCRYPTION=true
REDIS_BACKUP_ENCRYPTION_KEY=REPLACE_WITH_SECURE_32_CHAR_BACKUP_ENCRYPTION_KEY
REDIS_BACKUP_SCHEDULE="0 2 * * *"
REDIS_BACKUP_RETENTION_DAYS=30
REDIS_BACKUP_DIRECTORY=/backups/redis

# =====================================
# LOGGING AND MONITORING CONFIGURATION
# =====================================

# Log configuration
REDIS_LOG_LEVEL=notice
REDIS_LOG_FILE=/var/log/redis/redis.log
REDIS_SYSLOG_ENABLED=true
REDIS_SYSLOG_IDENT=redis-prod
REDIS_SYSLOG_FACILITY=local0

# Security monitoring
REDIS_ACL_LOG_MAX_LEN=256
REDIS_SLOW_LOG_THRESHOLD=10000
REDIS_SLOW_LOG_MAX_LEN=256
REDIS_LATENCY_MONITOR_THRESHOLD=100

# Audit logging (high-security environments)
REDIS_AUDIT_ENABLED=false
REDIS_AUDIT_LOG_FILE=/var/log/redis/redis-audit.log
REDIS_KEYSPACE_NOTIFICATIONS=false

# =====================================
# SECURITY HARDENING CONFIGURATION
# =====================================

# Protected mode (REQUIRED for production)
REDIS_PROTECTED_MODE=true

# Command renaming (security through obscurity)
REDIS_RENAME_DANGEROUS_COMMANDS=true

# Specific renamed commands (customize as needed)
REDIS_SHUTDOWN_COMMAND=REDIS_SHUTDOWN_SECURE_PROD
REDIS_DEL_COMMAND=REDIS_DEL_SECURE_PROD
REDIS_BGSAVE_COMMAND=REDIS_BGSAVE_SECURE_PROD
REDIS_INFO_COMMAND=REDIS_INFO_SECURE_PROD

# =====================================
# APPLICATION INTEGRATION CONFIGURATION
# =====================================

# Cache configuration
REDIS_DEFAULT_TTL=300
REDIS_MAX_TTL=3600
REDIS_CACHE_KEY_PREFIX=ai_migration_prod

# Cache encryption (for sensitive data)
REDIS_CACHE_ENCRYPTION=true
REDIS_CACHE_ENCRYPTION_KEY=REPLACE_WITH_SECURE_32_CHAR_CACHE_ENCRYPTION_KEY
REDIS_CACHE_ENCRYPT_PII=true
REDIS_CACHE_ENCRYPT_CREDENTIALS=true

# Flow management configuration
REDIS_FLOW_TIMEOUT=86400
REDIS_FLOW_MAX_ACTIVE=1000

# SSE configuration
REDIS_SSE_ENABLED=true
REDIS_SSE_TIMEOUT=3600

# =====================================
# MONITORING AND ALERTING CONFIGURATION
# =====================================

# Prometheus metrics
REDIS_METRICS_ENABLED=true
REDIS_METRICS_PORT=9121
REDIS_METRICS_ENDPOINT=/metrics

# Health check configuration
REDIS_HEALTH_CHECK_ENABLED=true
REDIS_HEALTH_CHECK_INTERVAL=30
REDIS_HEALTH_CHECK_TIMEOUT=10
REDIS_HEALTH_CHECK_RETRIES=3

# Alerting thresholds
REDIS_ALERT_MEMORY_THRESHOLD=0.85
REDIS_ALERT_CONNECTION_THRESHOLD=800
REDIS_ALERT_SLOW_QUERY_THRESHOLD=50
REDIS_ALERT_AUTH_FAILURE_THRESHOLD=10

# =====================================
# COMPLIANCE AND GOVERNANCE
# =====================================

# Data classification
REDIS_DATA_CLASSIFICATION=confidential
REDIS_ENVIRONMENT=production
REDIS_COMPLIANCE_GDPR=true
REDIS_COMPLIANCE_SOC2=true
REDIS_COMPLIANCE_HIPAA=false

# Retention policies
REDIS_LOG_RETENTION_DAYS=90
REDIS_AUDIT_RETENTION_DAYS=365
REDIS_METRICS_RETENTION_DAYS=30

# =====================================
# SECRET MANAGEMENT INTEGRATION
# =====================================

# Secret management system integration
# Uncomment and configure based on your secret management system

# AWS Secrets Manager
# REDIS_SECRETS_AWS_ENABLED=true
# REDIS_SECRETS_AWS_REGION=us-east-1
# REDIS_SECRETS_AWS_SECRET_NAME=redis/production/passwords

# HashiCorp Vault
# REDIS_SECRETS_VAULT_ENABLED=true
# REDIS_SECRETS_VAULT_ADDR=https://vault.company.com
# REDIS_SECRETS_VAULT_PATH=secret/redis/production

# Azure Key Vault
# REDIS_SECRETS_AZURE_ENABLED=true
# REDIS_SECRETS_AZURE_VAULT_URL=https://vault.vault.azure.net/
# REDIS_SECRETS_AZURE_CLIENT_ID=your-client-id

# =====================================
# DEVELOPMENT OVERRIDES (DO NOT USE IN PRODUCTION)
# =====================================

# These settings are for development/testing only
# NEVER enable in production environments

# Development mode (MUST be false in production)
REDIS_DEVELOPMENT_MODE=false

# Debug logging (MUST be false in production)
REDIS_DEBUG_ENABLED=false

# Disable authentication (NEVER use in production)
REDIS_AUTH_DISABLED=false

# Allow dangerous commands (NEVER use in production)
REDIS_ALLOW_DANGEROUS_COMMANDS=false

# =====================================
# DOCKER ENVIRONMENT SPECIFIC
# =====================================

# Docker-specific settings
REDIS_CONTAINER_NAME=migration_redis_prod
REDIS_DOCKER_NETWORK=redis_network
REDIS_DOCKER_RESTART_POLICY=unless-stopped

# Volume configuration
REDIS_DATA_VOLUME=redis_prod_data
REDIS_LOG_VOLUME=redis_logs
REDIS_CERT_VOLUME=redis_certs

# Resource limits (adjust based on your infrastructure)
REDIS_MEMORY_LIMIT=2G
REDIS_CPU_LIMIT=1.0
REDIS_MEMORY_RESERVATION=1G
REDIS_CPU_RESERVATION=0.5

# =====================================
# EXAMPLE VALUES FOR REFERENCE
# =====================================

# Example of secure password generation:
# REDIS_PASSWORD=$(openssl rand -base64 32)
# Result: "xK8vN2mQ7pL9sR4tY6uI1oP3mX5nZ8bC9dF0gH2jA4k="

# Example of TLS configuration for AWS ECS:
# REDIS_TLS_CERT_FILE=/etc/ssl/certs/redis-server.crt
# REDIS_TLS_KEY_FILE=/etc/ssl/private/redis-server.key

# Example of backup encryption key:
# REDIS_BACKUP_ENCRYPTION_KEY=$(openssl rand -base64 32)

# =====================================
# VALIDATION CHECKLIST
# =====================================

# Before deploying to production, ensure:
# [ ] All passwords are generated and stored securely
# [ ] TLS certificates are properly configured
# [ ] Network binding is restricted to localhost/specific IPs
# [ ] All dangerous commands are disabled
# [ ] Monitoring and alerting are configured
# [ ] Backup and recovery procedures are tested
# [ ] Security validation script passes
# [ ] Post-deployment security tests pass

# =====================================
# SECURITY CONTACTS
# =====================================

# Security team contact for Redis issues
SECURITY_TEAM_EMAIL=security@company.com
SECURITY_TEAM_SLACK=#security-alerts
REDIS_SECURITY_CONTACT=devops-redis@company.com

# Emergency escalation
SECURITY_EMERGENCY_PHONE=+1-XXX-XXX-XXXX
SECURITY_EMERGENCY_EMAIL=security-emergency@company.com
