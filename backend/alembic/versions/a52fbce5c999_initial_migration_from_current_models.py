"""Initial migration from current models

Revision ID: a52fbce5c999
Revises: 
Create Date: 2025-06-13 02:19:50.829409

"""
from alembic import op
import sqlalchemy as sa
import pgvector.sqlalchemy
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = 'a52fbce5c999'
down_revision = None
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('llm_model_pricing',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('provider', sa.String(length=100), nullable=False),
    sa.Column('model_name', sa.String(length=255), nullable=False),
    sa.Column('model_version', sa.String(length=100), nullable=True),
    sa.Column('input_cost_per_1k_tokens', sa.Numeric(precision=10, scale=6), nullable=False),
    sa.Column('output_cost_per_1k_tokens', sa.Numeric(precision=10, scale=6), nullable=False),
    sa.Column('currency', sa.String(length=10), nullable=False),
    sa.Column('effective_from', sa.DateTime(timezone=True), nullable=False),
    sa.Column('effective_to', sa.DateTime(timezone=True), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=False),
    sa.Column('source', sa.String(length=255), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('provider', 'model_name', 'model_version', 'effective_from', name='uq_model_pricing_version_date')
    )
    op.create_index('idx_model_pricing_active', 'llm_model_pricing', ['is_active', 'effective_from', 'effective_to'], unique=False)
    op.create_index('idx_model_pricing_provider_model', 'llm_model_pricing', ['provider', 'model_name'], unique=False)
    op.create_table('migrations',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('status', sa.Enum('PLANNING', 'IN_PROGRESS', 'COMPLETED', 'PAUSED', 'CANCELLED', name='migrationstatus'), nullable=True),
    sa.Column('current_phase', sa.Enum('DISCOVERY', 'ASSESS', 'PLAN', 'EXECUTE', 'MODERNIZE', 'FINOPS', 'OBSERVABILITY', 'DECOMMISSION', name='migrationphase'), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('start_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('target_completion_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('actual_completion_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('source_environment', sa.String(length=100), nullable=True),
    sa.Column('target_environment', sa.String(length=100), nullable=True),
    sa.Column('migration_strategy', sa.String(length=50), nullable=True),
    sa.Column('progress_percentage', sa.Integer(), nullable=True),
    sa.Column('total_assets', sa.Integer(), nullable=True),
    sa.Column('migrated_assets', sa.Integer(), nullable=True),
    sa.Column('ai_recommendations', sa.JSON(), nullable=True),
    sa.Column('risk_assessment', sa.JSON(), nullable=True),
    sa.Column('cost_estimates', sa.JSON(), nullable=True),
    sa.Column('settings', sa.JSON(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_migrations_id'), 'migrations', ['id'], unique=False)
    op.create_index(op.f('ix_migrations_name'), 'migrations', ['name'], unique=False)
    op.create_table('role_permissions',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('role_level', sa.String(length=30), nullable=False),
    sa.Column('can_manage_platform_settings', sa.Boolean(), nullable=True),
    sa.Column('can_manage_all_clients', sa.Boolean(), nullable=True),
    sa.Column('can_manage_all_users', sa.Boolean(), nullable=True),
    sa.Column('can_purge_deleted_data', sa.Boolean(), nullable=True),
    sa.Column('can_view_system_logs', sa.Boolean(), nullable=True),
    sa.Column('can_create_clients', sa.Boolean(), nullable=True),
    sa.Column('can_modify_client_settings', sa.Boolean(), nullable=True),
    sa.Column('can_manage_client_users', sa.Boolean(), nullable=True),
    sa.Column('can_delete_client_data', sa.Boolean(), nullable=True),
    sa.Column('can_create_engagements', sa.Boolean(), nullable=True),
    sa.Column('can_modify_engagement_settings', sa.Boolean(), nullable=True),
    sa.Column('can_manage_engagement_users', sa.Boolean(), nullable=True),
    sa.Column('can_delete_engagement_data', sa.Boolean(), nullable=True),
    sa.Column('can_import_data', sa.Boolean(), nullable=True),
    sa.Column('can_export_data', sa.Boolean(), nullable=True),
    sa.Column('can_view_analytics', sa.Boolean(), nullable=True),
    sa.Column('can_modify_data', sa.Boolean(), nullable=True),
    sa.Column('can_configure_agents', sa.Boolean(), nullable=True),
    sa.Column('can_view_agent_insights', sa.Boolean(), nullable=True),
    sa.Column('can_approve_agent_decisions', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_role_permissions_role_level'), 'role_permissions', ['role_level'], unique=False)
    op.create_table('sixr_parameters',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('parameter_key', sa.String(length=255), nullable=False),
    sa.Column('value', sa.JSON(), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_sixr_parameters_parameter_key'), 'sixr_parameters', ['parameter_key'], unique=True)
    op.create_table('sixr_questions',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('question_id', sa.String(length=100), nullable=False),
    sa.Column('question_text', sa.Text(), nullable=False),
    sa.Column('question_type', sa.Enum('TEXT', 'SELECT', 'MULTISELECT', 'FILE_UPLOAD', 'BOOLEAN', 'NUMERIC', name='questiontype'), nullable=False),
    sa.Column('category', sa.String(length=100), nullable=False),
    sa.Column('priority', sa.Integer(), nullable=True),
    sa.Column('required', sa.Boolean(), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('options', sa.JSON(), nullable=True),
    sa.Column('validation_rules', sa.JSON(), nullable=True),
    sa.Column('help_text', sa.Text(), nullable=True),
    sa.Column('depends_on', sa.String(length=100), nullable=True),
    sa.Column('show_conditions', sa.JSON(), nullable=True),
    sa.Column('skip_conditions', sa.JSON(), nullable=True),
    sa.Column('created_by', sa.String(length=100), nullable=True),
    sa.Column('updated_by', sa.String(length=100), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('version', sa.String(length=20), nullable=True),
    sa.Column('parent_question_id', sa.String(length=100), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_sixr_questions_id'), 'sixr_questions', ['id'], unique=False)
    op.create_index(op.f('ix_sixr_questions_question_id'), 'sixr_questions', ['question_id'], unique=True)
    op.create_table('users',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('email', sa.String(length=255), nullable=False),
    sa.Column('password_hash', sa.String(length=255), nullable=True),
    sa.Column('first_name', sa.String(length=100), nullable=True),
    sa.Column('last_name', sa.String(length=100), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('is_verified', sa.Boolean(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('last_login', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_users_email'), 'users', ['email'], unique=True)
    op.create_index(op.f('ix_users_id'), 'users', ['id'], unique=False)
    op.create_index(op.f('ix_users_is_active'), 'users', ['is_active'], unique=False)
    op.create_index(op.f('ix_users_is_mock'), 'users', ['is_mock'], unique=False)
    op.create_table('client_accounts',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('slug', sa.String(length=100), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('industry', sa.String(length=100), nullable=True),
    sa.Column('company_size', sa.String(length=50), nullable=True),
    sa.Column('headquarters_location', sa.String(length=255), nullable=True),
    sa.Column('primary_contact_name', sa.String(length=255), nullable=True),
    sa.Column('primary_contact_email', sa.String(length=255), nullable=True),
    sa.Column('primary_contact_phone', sa.String(length=50), nullable=True),
    sa.Column('subscription_tier', sa.String(length=50), nullable=True),
    sa.Column('billing_contact_email', sa.String(length=255), nullable=True),
    sa.Column('settings', sa.JSON(), nullable=True),
    sa.Column('branding', sa.JSON(), nullable=True),
    sa.Column('business_objectives', sa.JSON(), nullable=True),
    sa.Column('it_guidelines', sa.JSON(), nullable=True),
    sa.Column('decision_criteria', sa.JSON(), nullable=True),
    sa.Column('agent_preferences', sa.JSON(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=False),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_client_accounts_id'), 'client_accounts', ['id'], unique=False)
    op.create_index(op.f('ix_client_accounts_is_active'), 'client_accounts', ['is_active'], unique=False)
    op.create_index(op.f('ix_client_accounts_is_mock'), 'client_accounts', ['is_mock'], unique=False)
    op.create_index(op.f('ix_client_accounts_slug'), 'client_accounts', ['slug'], unique=True)
    op.create_table('migration_logs',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('migration_id', sa.UUID(), nullable=False),
    sa.Column('timestamp', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('level', sa.String(length=20), nullable=True),
    sa.Column('message', sa.Text(), nullable=False),
    sa.Column('details', sa.JSON(), nullable=True),
    sa.Column('phase', sa.Enum('DISCOVERY', 'ASSESS', 'PLAN', 'EXECUTE', 'MODERNIZE', 'FINOPS', 'OBSERVABILITY', 'DECOMMISSION', name='migrationphase'), nullable=True),
    sa.Column('user_id', sa.String(length=100), nullable=True),
    sa.Column('action', sa.String(length=100), nullable=True),
    sa.ForeignKeyConstraint(['migration_id'], ['migrations.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_migration_logs_id'), 'migration_logs', ['id'], unique=False)
    op.create_table('user_profiles',
    sa.Column('user_id', sa.UUID(), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('approval_requested_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('approved_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('approved_by', sa.UUID(), nullable=True),
    sa.Column('registration_reason', sa.Text(), nullable=True),
    sa.Column('organization', sa.String(length=255), nullable=True),
    sa.Column('role_description', sa.String(length=255), nullable=True),
    sa.Column('requested_access_level', sa.String(length=20), nullable=True),
    sa.Column('phone_number', sa.String(length=20), nullable=True),
    sa.Column('manager_email', sa.String(length=255), nullable=True),
    sa.Column('linkedin_profile', sa.String(length=255), nullable=True),
    sa.Column('last_login_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('login_count', sa.Integer(), nullable=True),
    sa.Column('failed_login_attempts', sa.Integer(), nullable=True),
    sa.Column('last_failed_login', sa.DateTime(timezone=True), nullable=True),
    sa.Column('notification_preferences', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['approved_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('user_id')
    )
    op.create_index(op.f('ix_user_profiles_status'), 'user_profiles', ['status'], unique=False)
    op.create_table('client_access',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('user_profile_id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('access_level', sa.String(length=20), nullable=False),
    sa.Column('permissions', sa.JSON(), nullable=True),
    sa.Column('restricted_environments', sa.JSON(), nullable=True),
    sa.Column('restricted_data_types', sa.JSON(), nullable=True),
    sa.Column('granted_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('granted_by', sa.UUID(), nullable=False),
    sa.Column('expires_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('last_accessed_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('access_count', sa.Integer(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['granted_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['user_profile_id'], ['user_profiles.user_id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_client_access_client_account_id'), 'client_access', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_client_access_id'), 'client_access', ['id'], unique=False)
    op.create_index(op.f('ix_client_access_is_active'), 'client_access', ['is_active'], unique=False)
    op.create_index(op.f('ix_client_access_user_profile_id'), 'client_access', ['user_profile_id'], unique=False)
    op.create_table('custom_target_fields',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('field_name', sa.String(), nullable=False),
    sa.Column('field_type', sa.String(), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('is_required', sa.Boolean(), nullable=True),
    sa.Column('is_critical', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=True),
    sa.Column('validation_schema', sa.JSON(), nullable=True),
    sa.Column('default_value', sa.String(), nullable=True),
    sa.Column('allowed_values', sa.JSON(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('engagements',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('slug', sa.String(length=100), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('engagement_type', sa.String(length=50), nullable=True),
    sa.Column('status', sa.String(length=50), nullable=True),
    sa.Column('priority', sa.String(length=20), nullable=True),
    sa.Column('start_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('target_completion_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('actual_completion_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('engagement_lead_id', sa.UUID(), nullable=True),
    sa.Column('client_contact_name', sa.String(length=255), nullable=True),
    sa.Column('client_contact_email', sa.String(length=255), nullable=True),
    sa.Column('settings', sa.JSON(), nullable=True),
    sa.Column('migration_scope', sa.JSON(), nullable=True),
    sa.Column('team_preferences', sa.JSON(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['engagement_lead_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_engagements_client_account_id'), 'engagements', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_engagements_id'), 'engagements', ['id'], unique=False)
    op.create_index(op.f('ix_engagements_is_active'), 'engagements', ['is_active'], unique=False)
    op.create_index(op.f('ix_engagements_is_mock'), 'engagements', ['is_mock'], unique=False)
    op.create_index(op.f('ix_engagements_status'), 'engagements', ['status'], unique=False)
    op.create_table('tags',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('name', sa.String(length=100), nullable=False),
    sa.Column('category', sa.String(length=50), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('reference_embedding', pgvector.sqlalchemy.vector.VECTOR(dim=1536), nullable=True),
    sa.Column('confidence_threshold', sa.Float(), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('usage_count', sa.Integer(), nullable=True),
    sa.Column('last_used', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_tags_category'), 'tags', ['category'], unique=False)
    op.create_index(op.f('ix_tags_client_account_id'), 'tags', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_tags_id'), 'tags', ['id'], unique=False)
    op.create_index(op.f('ix_tags_is_active'), 'tags', ['is_active'], unique=False)
    op.create_index(op.f('ix_tags_is_mock'), 'tags', ['is_mock'], unique=False)
    op.create_index(op.f('ix_tags_name'), 'tags', ['name'], unique=True)
    op.create_table('user_account_associations',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('user_id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('role', sa.String(length=50), nullable=False),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('user_id', 'client_account_id', name='_user_client_account_uc')
    )
    op.create_index(op.f('ix_user_account_associations_client_account_id'), 'user_account_associations', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_user_account_associations_is_mock'), 'user_account_associations', ['is_mock'], unique=False)
    op.create_index(op.f('ix_user_account_associations_user_id'), 'user_account_associations', ['user_id'], unique=False)
    op.create_table('cmdb_sixr_analyses',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('analysis_name', sa.String(length=255), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('status', sa.String(length=50), nullable=True),
    sa.Column('total_assets', sa.Integer(), nullable=True),
    sa.Column('rehost_count', sa.Integer(), nullable=True),
    sa.Column('replatform_count', sa.Integer(), nullable=True),
    sa.Column('refactor_count', sa.Integer(), nullable=True),
    sa.Column('rearchitect_count', sa.Integer(), nullable=True),
    sa.Column('retire_count', sa.Integer(), nullable=True),
    sa.Column('retain_count', sa.Integer(), nullable=True),
    sa.Column('total_current_cost', sa.Float(), nullable=True),
    sa.Column('total_estimated_cost', sa.Float(), nullable=True),
    sa.Column('potential_savings', sa.Float(), nullable=True),
    sa.Column('analysis_results', sa.JSON(), nullable=True),
    sa.Column('recommendations', sa.JSON(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_cmdb_sixr_analyses_client_account_id'), 'cmdb_sixr_analyses', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_cmdb_sixr_analyses_engagement_id'), 'cmdb_sixr_analyses', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_cmdb_sixr_analyses_id'), 'cmdb_sixr_analyses', ['id'], unique=False)
    op.create_index(op.f('ix_cmdb_sixr_analyses_is_mock'), 'cmdb_sixr_analyses', ['is_mock'], unique=False)
    op.create_index(op.f('ix_cmdb_sixr_analyses_status'), 'cmdb_sixr_analyses', ['status'], unique=False)
    op.create_table('data_import_sessions',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('session_name', sa.String(length=255), nullable=False),
    sa.Column('session_display_name', sa.String(length=255), nullable=True),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('is_default', sa.Boolean(), nullable=False),
    sa.Column('parent_session_id', sa.UUID(), nullable=True),
    sa.Column('session_type', sa.String(length=50), nullable=False),
    sa.Column('auto_created', sa.Boolean(), nullable=False),
    sa.Column('source_filename', sa.String(length=255), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('progress_percentage', sa.Integer(), nullable=True),
    sa.Column('total_imports', sa.Integer(), nullable=True),
    sa.Column('total_assets_processed', sa.Integer(), nullable=True),
    sa.Column('total_records_imported', sa.Integer(), nullable=True),
    sa.Column('data_quality_score', sa.Integer(), nullable=True),
    sa.Column('session_config', sa.JSON(), nullable=True),
    sa.Column('business_context', sa.JSON(), nullable=True),
    sa.Column('agent_insights', sa.JSON(), nullable=True),
    sa.Column('started_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('completed_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('last_activity_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=False),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['parent_session_id'], ['data_import_sessions.id'], ondelete='SET NULL'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_data_import_sessions_client_account_id'), 'data_import_sessions', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_data_import_sessions_engagement_id'), 'data_import_sessions', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_data_import_sessions_id'), 'data_import_sessions', ['id'], unique=False)
    op.create_index(op.f('ix_data_import_sessions_is_default'), 'data_import_sessions', ['is_default'], unique=False)
    op.create_index(op.f('ix_data_import_sessions_is_mock'), 'data_import_sessions', ['is_mock'], unique=False)
    op.create_index(op.f('ix_data_import_sessions_session_name'), 'data_import_sessions', ['session_name'], unique=False)
    op.create_index(op.f('ix_data_import_sessions_status'), 'data_import_sessions', ['status'], unique=False)
    op.create_table('engagement_access',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('user_profile_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('access_level', sa.String(length=20), nullable=False),
    sa.Column('engagement_role', sa.String(length=100), nullable=True),
    sa.Column('permissions', sa.JSON(), nullable=True),
    sa.Column('restricted_sessions', sa.JSON(), nullable=True),
    sa.Column('allowed_session_types', sa.JSON(), nullable=True),
    sa.Column('granted_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('granted_by', sa.UUID(), nullable=False),
    sa.Column('expires_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('last_accessed_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('access_count', sa.Integer(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['granted_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['user_profile_id'], ['user_profiles.user_id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_engagement_access_engagement_id'), 'engagement_access', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_engagement_access_id'), 'engagement_access', ['id'], unique=False)
    op.create_index(op.f('ix_engagement_access_is_active'), 'engagement_access', ['is_active'], unique=False)
    op.create_index(op.f('ix_engagement_access_user_profile_id'), 'engagement_access', ['user_profile_id'], unique=False)
    op.create_table('enhanced_access_audit_log',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('user_id', sa.UUID(), nullable=False),
    sa.Column('action_type', sa.String(length=50), nullable=False),
    sa.Column('resource_type', sa.String(length=50), nullable=True),
    sa.Column('resource_id', sa.String(length=255), nullable=True),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('result', sa.String(length=20), nullable=False),
    sa.Column('reason', sa.Text(), nullable=True),
    sa.Column('ip_address', sa.String(length=45), nullable=True),
    sa.Column('user_agent', sa.Text(), nullable=True),
    sa.Column('details', sa.JSON(), nullable=True),
    sa.Column('user_role_level', sa.String(length=30), nullable=True),
    sa.Column('user_data_scope', sa.String(length=20), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_enhanced_access_audit_log_action_type'), 'enhanced_access_audit_log', ['action_type'], unique=False)
    op.create_index(op.f('ix_enhanced_access_audit_log_created_at'), 'enhanced_access_audit_log', ['created_at'], unique=False)
    op.create_index(op.f('ix_enhanced_access_audit_log_user_id'), 'enhanced_access_audit_log', ['user_id'], unique=False)
    op.create_table('enhanced_user_profiles',
    sa.Column('user_id', sa.UUID(), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('role_level', sa.String(length=30), nullable=False),
    sa.Column('data_scope', sa.String(length=20), nullable=False),
    sa.Column('scope_client_account_id', sa.UUID(), nullable=True),
    sa.Column('scope_engagement_id', sa.UUID(), nullable=True),
    sa.Column('registration_reason', sa.Text(), nullable=True),
    sa.Column('organization', sa.String(length=255), nullable=True),
    sa.Column('role_description', sa.String(length=255), nullable=True),
    sa.Column('phone_number', sa.String(length=20), nullable=True),
    sa.Column('manager_email', sa.String(length=255), nullable=True),
    sa.Column('approval_requested_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('approved_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('approved_by', sa.UUID(), nullable=True),
    sa.Column('last_login_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('login_count', sa.Integer(), nullable=True),
    sa.Column('failed_login_attempts', sa.Integer(), nullable=True),
    sa.Column('is_deleted', sa.Boolean(), nullable=True),
    sa.Column('deleted_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('deleted_by', sa.UUID(), nullable=True),
    sa.Column('delete_reason', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['approved_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['deleted_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['scope_client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['scope_engagement_id'], ['engagements.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('user_id')
    )
    op.create_index(op.f('ix_enhanced_user_profiles_data_scope'), 'enhanced_user_profiles', ['data_scope'], unique=False)
    op.create_index(op.f('ix_enhanced_user_profiles_is_deleted'), 'enhanced_user_profiles', ['is_deleted'], unique=False)
    op.create_index(op.f('ix_enhanced_user_profiles_role_level'), 'enhanced_user_profiles', ['role_level'], unique=False)
    op.create_index(op.f('ix_enhanced_user_profiles_status'), 'enhanced_user_profiles', ['status'], unique=False)
    op.create_table('feedback',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('feedback_type', sa.String(length=50), nullable=False),
    sa.Column('page', sa.String(length=255), nullable=True),
    sa.Column('rating', sa.Integer(), nullable=True),
    sa.Column('comment', sa.Text(), nullable=True),
    sa.Column('category', sa.String(length=50), nullable=True),
    sa.Column('breadcrumb', sa.String(length=500), nullable=True),
    sa.Column('filename', sa.String(length=255), nullable=True),
    sa.Column('original_analysis', sa.JSON(), nullable=True),
    sa.Column('user_corrections', sa.JSON(), nullable=True),
    sa.Column('asset_type_override', sa.String(length=100), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('processed', sa.Boolean(), nullable=True),
    sa.Column('user_agent', sa.String(length=500), nullable=True),
    sa.Column('user_timestamp', sa.String(length=50), nullable=True),
    sa.Column('client_ip', sa.String(length=45), nullable=True),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('learning_patterns_extracted', sa.JSON(), nullable=True),
    sa.Column('confidence_impact', sa.Float(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('processed_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_feedback_feedback_type'), 'feedback', ['feedback_type'], unique=False)
    op.create_index(op.f('ix_feedback_id'), 'feedback', ['id'], unique=False)
    op.create_index(op.f('ix_feedback_page'), 'feedback', ['page'], unique=False)
    op.create_table('feedback_summaries',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('feedback_type', sa.String(length=50), nullable=False),
    sa.Column('page', sa.String(length=255), nullable=True),
    sa.Column('time_period', sa.String(length=20), nullable=True),
    sa.Column('total_feedback', sa.Integer(), nullable=True),
    sa.Column('average_rating', sa.Float(), nullable=True),
    sa.Column('status_counts', sa.JSON(), nullable=True),
    sa.Column('rating_distribution', sa.JSON(), nullable=True),
    sa.Column('category_counts', sa.JSON(), nullable=True),
    sa.Column('feedback_trend', sa.JSON(), nullable=True),
    sa.Column('rating_trend', sa.JSON(), nullable=True),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('last_calculated', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('calculation_duration_ms', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_feedback_summaries_feedback_type'), 'feedback_summaries', ['feedback_type'], unique=False)
    op.create_index(op.f('ix_feedback_summaries_id'), 'feedback_summaries', ['id'], unique=False)
    op.create_index(op.f('ix_feedback_summaries_page'), 'feedback_summaries', ['page'], unique=False)
    op.create_table('llm_usage_logs',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('username', sa.String(length=255), nullable=True),
    sa.Column('session_id', sa.String(length=255), nullable=True),
    sa.Column('request_id', sa.String(length=255), nullable=True),
    sa.Column('endpoint', sa.String(length=500), nullable=True),
    sa.Column('page_context', sa.String(length=255), nullable=True),
    sa.Column('feature_context', sa.String(length=255), nullable=True),
    sa.Column('llm_provider', sa.String(length=100), nullable=False),
    sa.Column('model_name', sa.String(length=255), nullable=False),
    sa.Column('model_version', sa.String(length=100), nullable=True),
    sa.Column('input_tokens', sa.Integer(), nullable=True),
    sa.Column('output_tokens', sa.Integer(), nullable=True),
    sa.Column('total_tokens', sa.Integer(), nullable=True),
    sa.Column('input_cost', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('output_cost', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('total_cost', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('cost_currency', sa.String(length=10), nullable=False),
    sa.Column('response_time_ms', sa.Integer(), nullable=True),
    sa.Column('success', sa.Boolean(), nullable=False),
    sa.Column('error_type', sa.String(length=255), nullable=True),
    sa.Column('error_message', sa.Text(), nullable=True),
    sa.Column('request_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('response_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('additional_metadata', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('ip_address', sa.String(length=45), nullable=True),
    sa.Column('user_agent', sa.String(length=500), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_llm_usage_client_account', 'llm_usage_logs', ['client_account_id'], unique=False)
    op.create_index('idx_llm_usage_cost_analysis', 'llm_usage_logs', ['client_account_id', 'llm_provider', 'model_name', 'created_at'], unique=False)
    op.create_index('idx_llm_usage_created_at', 'llm_usage_logs', ['created_at'], unique=False)
    op.create_index('idx_llm_usage_engagement', 'llm_usage_logs', ['engagement_id'], unique=False)
    op.create_index('idx_llm_usage_feature_context', 'llm_usage_logs', ['feature_context'], unique=False)
    op.create_index('idx_llm_usage_page_context', 'llm_usage_logs', ['page_context'], unique=False)
    op.create_index('idx_llm_usage_provider_model', 'llm_usage_logs', ['llm_provider', 'model_name'], unique=False)
    op.create_index('idx_llm_usage_reporting', 'llm_usage_logs', ['client_account_id', 'created_at', 'success'], unique=False)
    op.create_index('idx_llm_usage_success', 'llm_usage_logs', ['success'], unique=False)
    op.create_index('idx_llm_usage_user', 'llm_usage_logs', ['user_id'], unique=False)
    op.create_table('llm_usage_summary',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('period_type', sa.String(length=20), nullable=False),
    sa.Column('period_start', sa.DateTime(timezone=True), nullable=False),
    sa.Column('period_end', sa.DateTime(timezone=True), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('llm_provider', sa.String(length=100), nullable=True),
    sa.Column('model_name', sa.String(length=255), nullable=True),
    sa.Column('page_context', sa.String(length=255), nullable=True),
    sa.Column('feature_context', sa.String(length=255), nullable=True),
    sa.Column('total_requests', sa.Integer(), nullable=False),
    sa.Column('successful_requests', sa.Integer(), nullable=False),
    sa.Column('failed_requests', sa.Integer(), nullable=False),
    sa.Column('total_input_tokens', sa.BigInteger(), nullable=False),
    sa.Column('total_output_tokens', sa.BigInteger(), nullable=False),
    sa.Column('total_tokens', sa.BigInteger(), nullable=False),
    sa.Column('total_cost', sa.Numeric(precision=12, scale=6), nullable=False),
    sa.Column('avg_response_time_ms', sa.Integer(), nullable=True),
    sa.Column('min_response_time_ms', sa.Integer(), nullable=True),
    sa.Column('max_response_time_ms', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('period_type', 'period_start', 'client_account_id', 'engagement_id', 'user_id', 'llm_provider', 'model_name', 'page_context', 'feature_context', name='uq_usage_summary_period_context')
    )
    op.create_index('idx_usage_summary_client', 'llm_usage_summary', ['client_account_id', 'period_start'], unique=False)
    op.create_index('idx_usage_summary_model', 'llm_usage_summary', ['llm_provider', 'model_name', 'period_start'], unique=False)
    op.create_index('idx_usage_summary_period', 'llm_usage_summary', ['period_type', 'period_start', 'period_end'], unique=False)
    op.create_table('mapping_learning_patterns',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('source_column', sa.String(length=255), nullable=False),
    sa.Column('target_column', sa.String(length=255), nullable=False),
    sa.Column('pattern_type', sa.String(length=50), nullable=False, comment="e.g., 'regex', 'value_map', 'synonym'"),
    sa.Column('pattern_details', sa.JSON(), nullable=False, comment='Details of the learned pattern, e.g., the regex string or a value mapping dictionary'),
    sa.Column('confidence_score', sa.JSON(), nullable=True),
    sa.Column('created_by', sa.String(length=100), nullable=False, comment='Identifier for the agent or user who created the pattern'),
    sa.Column('last_used_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('usage_count', sa.JSON(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_mapping_learning_patterns_engagement_id'), 'mapping_learning_patterns', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_mapping_learning_patterns_source_column'), 'mapping_learning_patterns', ['source_column'], unique=False)
    op.create_index(op.f('ix_mapping_learning_patterns_target_column'), 'mapping_learning_patterns', ['target_column'], unique=False)
    op.create_table('migration_waves',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('wave_number', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('status', sa.String(length=50), nullable=True),
    sa.Column('planned_start_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('planned_end_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('actual_start_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('actual_end_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('total_assets', sa.Integer(), nullable=True),
    sa.Column('completed_assets', sa.Integer(), nullable=True),
    sa.Column('failed_assets', sa.Integer(), nullable=True),
    sa.Column('estimated_cost', sa.Float(), nullable=True),
    sa.Column('actual_cost', sa.Float(), nullable=True),
    sa.Column('estimated_effort_hours', sa.Float(), nullable=True),
    sa.Column('actual_effort_hours', sa.Float(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_migration_waves_client_account_id'), 'migration_waves', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_migration_waves_engagement_id'), 'migration_waves', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_migration_waves_id'), 'migration_waves', ['id'], unique=False)
    op.create_index(op.f('ix_migration_waves_is_mock'), 'migration_waves', ['is_mock'], unique=False)
    op.create_index(op.f('ix_migration_waves_status'), 'migration_waves', ['status'], unique=False)
    op.create_index(op.f('ix_migration_waves_wave_number'), 'migration_waves', ['wave_number'], unique=False)
    op.create_table('sixr_analyses',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('migration_id', sa.UUID(), nullable=True),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('status', sa.Enum('PENDING', 'IN_PROGRESS', 'COMPLETED', 'FAILED', 'REQUIRES_INPUT', name='analysisstatus'), nullable=False),
    sa.Column('priority', sa.Integer(), nullable=True),
    sa.Column('application_ids', sa.JSON(), nullable=True),
    sa.Column('application_data', sa.JSON(), nullable=True),
    sa.Column('current_iteration', sa.Integer(), nullable=True),
    sa.Column('progress_percentage', sa.Float(), nullable=True),
    sa.Column('estimated_completion', sa.DateTime(timezone=True), nullable=True),
    sa.Column('final_recommendation', sa.Enum('REHOST', 'REPLATFORM', 'REFACTOR', 'REARCHITECT', 'REWRITE', 'REPLACE', 'RETIRE', name='sixrstrategy'), nullable=True),
    sa.Column('confidence_score', sa.Float(), nullable=True),
    sa.Column('created_by', sa.String(length=100), nullable=True),
    sa.Column('updated_by', sa.String(length=100), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('analysis_config', sa.JSON(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['migration_id'], ['migrations.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_sixr_analyses_client_account_id'), 'sixr_analyses', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_sixr_analyses_engagement_id'), 'sixr_analyses', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_sixr_analyses_id'), 'sixr_analyses', ['id'], unique=False)
    op.create_index(op.f('ix_sixr_analyses_name'), 'sixr_analyses', ['name'], unique=False)
    op.create_table('soft_deleted_items',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('item_type', sa.String(length=30), nullable=False),
    sa.Column('item_id', sa.UUID(), nullable=False),
    sa.Column('item_name', sa.String(length=255), nullable=True),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('deleted_by', sa.UUID(), nullable=False),
    sa.Column('deleted_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('delete_reason', sa.Text(), nullable=True),
    sa.Column('reviewed_by', sa.UUID(), nullable=True),
    sa.Column('reviewed_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('review_decision', sa.String(length=20), nullable=True),
    sa.Column('review_notes', sa.Text(), nullable=True),
    sa.Column('purged_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('purged_by', sa.UUID(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['deleted_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ),
    sa.ForeignKeyConstraint(['purged_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['reviewed_by'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_soft_deleted_items_item_id'), 'soft_deleted_items', ['item_id'], unique=False)
    op.create_index(op.f('ix_soft_deleted_items_item_type'), 'soft_deleted_items', ['item_type'], unique=False)
    op.create_index(op.f('ix_soft_deleted_items_status'), 'soft_deleted_items', ['status'], unique=False)
    op.create_table('user_roles',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('user_id', sa.UUID(), nullable=False),
    sa.Column('role_type', sa.String(length=50), nullable=False),
    sa.Column('role_name', sa.String(length=100), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('permissions', sa.JSON(), nullable=True),
    sa.Column('scope_type', sa.String(length=20), nullable=True),
    sa.Column('scope_client_id', sa.UUID(), nullable=True),
    sa.Column('scope_engagement_id', sa.UUID(), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('assigned_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('assigned_by', sa.UUID(), nullable=False),
    sa.Column('expires_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['assigned_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['scope_client_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['scope_engagement_id'], ['engagements.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_user_roles_id'), 'user_roles', ['id'], unique=False)
    op.create_index(op.f('ix_user_roles_is_active'), 'user_roles', ['is_active'], unique=False)
    op.create_index(op.f('ix_user_roles_user_id'), 'user_roles', ['user_id'], unique=False)
    op.create_table('wave_plans',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('migration_id', sa.UUID(), nullable=False),
    sa.Column('wave_number', sa.Integer(), nullable=False),
    sa.Column('wave_name', sa.String(length=255), nullable=True),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('planned_start_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('planned_end_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('actual_start_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('actual_end_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('total_assets', sa.Integer(), nullable=True),
    sa.Column('completed_assets', sa.Integer(), nullable=True),
    sa.Column('estimated_effort_hours', sa.Integer(), nullable=True),
    sa.Column('estimated_cost', sa.Float(), nullable=True),
    sa.Column('prerequisites', sa.JSON(), nullable=True),
    sa.Column('dependencies', sa.JSON(), nullable=True),
    sa.Column('constraints', sa.JSON(), nullable=True),
    sa.Column('overall_risk_level', sa.Enum('LOW', 'MEDIUM', 'HIGH', 'CRITICAL', name='risklevel'), nullable=True),
    sa.Column('complexity_score', sa.Float(), nullable=True),
    sa.Column('success_criteria', sa.JSON(), nullable=True),
    sa.Column('status', sa.String(length=50), nullable=True),
    sa.Column('progress_percentage', sa.Float(), nullable=True),
    sa.Column('ai_recommendations', sa.JSON(), nullable=True),
    sa.Column('optimization_score', sa.Float(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['migration_id'], ['migrations.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_wave_plans_client_account_id'), 'wave_plans', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_wave_plans_engagement_id'), 'wave_plans', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_wave_plans_id'), 'wave_plans', ['id'], unique=False)
    op.create_table('access_audit_log',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('user_id', sa.UUID(), nullable=False),
    sa.Column('action_type', sa.String(length=50), nullable=False),
    sa.Column('resource_type', sa.String(length=50), nullable=True),
    sa.Column('resource_id', sa.String(length=255), nullable=True),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('session_id', sa.UUID(), nullable=True),
    sa.Column('result', sa.String(length=20), nullable=False),
    sa.Column('reason', sa.Text(), nullable=True),
    sa.Column('ip_address', sa.String(length=45), nullable=True),
    sa.Column('user_agent', sa.Text(), nullable=True),
    sa.Column('details', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ),
    sa.ForeignKeyConstraint(['session_id'], ['data_import_sessions.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_access_audit_log_action_type'), 'access_audit_log', ['action_type'], unique=False)
    op.create_index(op.f('ix_access_audit_log_created_at'), 'access_audit_log', ['created_at'], unique=False)
    op.create_index(op.f('ix_access_audit_log_id'), 'access_audit_log', ['id'], unique=False)
    op.create_index(op.f('ix_access_audit_log_user_id'), 'access_audit_log', ['user_id'], unique=False)
    op.create_table('assets',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('session_id', sa.UUID(), nullable=True),
    sa.Column('migration_id', sa.UUID(), nullable=True),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('asset_name', sa.String(length=255), nullable=True),
    sa.Column('hostname', sa.String(length=255), nullable=True),
    sa.Column('asset_type', sa.Enum('SERVER', 'DATABASE', 'APPLICATION', 'NETWORK', 'LOAD_BALANCER', 'STORAGE', 'SECURITY_GROUP', 'VIRTUAL_MACHINE', 'CONTAINER', 'OTHER', name='assettype'), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('ip_address', sa.String(length=45), nullable=True),
    sa.Column('fqdn', sa.String(length=255), nullable=True),
    sa.Column('mac_address', sa.String(length=17), nullable=True),
    sa.Column('environment', sa.String(length=50), nullable=True),
    sa.Column('location', sa.String(length=100), nullable=True),
    sa.Column('datacenter', sa.String(length=100), nullable=True),
    sa.Column('rack_location', sa.String(length=50), nullable=True),
    sa.Column('availability_zone', sa.String(length=50), nullable=True),
    sa.Column('operating_system', sa.String(length=100), nullable=True),
    sa.Column('os_version', sa.String(length=50), nullable=True),
    sa.Column('cpu_cores', sa.Integer(), nullable=True),
    sa.Column('memory_gb', sa.Float(), nullable=True),
    sa.Column('storage_gb', sa.Float(), nullable=True),
    sa.Column('business_owner', sa.String(length=255), nullable=True),
    sa.Column('technical_owner', sa.String(length=255), nullable=True),
    sa.Column('department', sa.String(length=100), nullable=True),
    sa.Column('application_name', sa.String(length=255), nullable=True),
    sa.Column('technology_stack', sa.String(length=255), nullable=True),
    sa.Column('criticality', sa.String(length=20), nullable=True),
    sa.Column('business_criticality', sa.String(length=20), nullable=True),
    sa.Column('custom_attributes', sa.JSON(), nullable=True),
    sa.Column('status', sa.Enum('DISCOVERED', 'ASSESSED', 'PLANNED', 'MIGRATING', 'MIGRATED', 'FAILED', 'EXCLUDED', name='assetstatus'), nullable=True),
    sa.Column('six_r_strategy', sa.Enum('REHOST', 'REPLATFORM', 'REFACTOR', 'REARCHITECT', 'REPLACE', 'RETIRE', 'RETAIN', name='sixrstrategy'), nullable=True),
    sa.Column('mapping_status', sa.String(length=20), nullable=True),
    sa.Column('migration_priority', sa.Integer(), nullable=True),
    sa.Column('migration_complexity', sa.String(length=20), nullable=True),
    sa.Column('migration_wave', sa.Integer(), nullable=True),
    sa.Column('sixr_ready', sa.String(length=50), nullable=True),
    sa.Column('dependencies', sa.JSON(), nullable=True),
    sa.Column('related_assets', sa.JSON(), nullable=True),
    sa.Column('discovery_method', sa.String(length=50), nullable=True),
    sa.Column('discovery_source', sa.String(length=100), nullable=True),
    sa.Column('discovery_timestamp', sa.DateTime(timezone=True), nullable=True),
    sa.Column('cpu_utilization_percent', sa.Float(), nullable=True),
    sa.Column('memory_utilization_percent', sa.Float(), nullable=True),
    sa.Column('disk_iops', sa.Float(), nullable=True),
    sa.Column('network_throughput_mbps', sa.Float(), nullable=True),
    sa.Column('completeness_score', sa.Float(), nullable=True),
    sa.Column('quality_score', sa.Float(), nullable=True),
    sa.Column('current_monthly_cost', sa.Float(), nullable=True),
    sa.Column('estimated_cloud_cost', sa.Float(), nullable=True),
    sa.Column('imported_by', sa.UUID(), nullable=True),
    sa.Column('imported_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('source_filename', sa.String(length=255), nullable=True),
    sa.Column('raw_data', sa.JSON(), nullable=True),
    sa.Column('field_mappings_used', sa.JSON(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_by', sa.UUID(), nullable=True),
    sa.Column('updated_by', sa.UUID(), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['created_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['imported_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['migration_id'], ['migrations.id'], ),
    sa.ForeignKeyConstraint(['session_id'], ['data_import_sessions.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['updated_by'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_assets_asset_type'), 'assets', ['asset_type'], unique=False)
    op.create_index(op.f('ix_assets_client_account_id'), 'assets', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_assets_engagement_id'), 'assets', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_assets_environment'), 'assets', ['environment'], unique=False)
    op.create_index(op.f('ix_assets_hostname'), 'assets', ['hostname'], unique=False)
    op.create_index(op.f('ix_assets_id'), 'assets', ['id'], unique=False)
    op.create_index(op.f('ix_assets_is_mock'), 'assets', ['is_mock'], unique=False)
    op.create_index(op.f('ix_assets_mapping_status'), 'assets', ['mapping_status'], unique=False)
    op.create_index(op.f('ix_assets_name'), 'assets', ['name'], unique=False)
    op.create_index(op.f('ix_assets_session_id'), 'assets', ['session_id'], unique=False)
    op.create_index(op.f('ix_assets_status'), 'assets', ['status'], unique=False)
    op.create_table('data_imports',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('session_id', sa.UUID(), nullable=True),
    sa.Column('import_name', sa.String(length=255), nullable=False),
    sa.Column('import_type', sa.String(length=50), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('source_filename', sa.String(length=255), nullable=False),
    sa.Column('file_size_bytes', sa.Integer(), nullable=True),
    sa.Column('file_type', sa.String(length=100), nullable=True),
    sa.Column('file_hash', sa.String(length=64), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('progress_percentage', sa.Float(), nullable=True),
    sa.Column('total_records', sa.Integer(), nullable=True),
    sa.Column('processed_records', sa.Integer(), nullable=True),
    sa.Column('failed_records', sa.Integer(), nullable=True),
    sa.Column('import_config', sa.JSON(), nullable=True),
    sa.Column('imported_by', sa.UUID(), nullable=False),
    sa.Column('started_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('completed_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['imported_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['session_id'], ['data_import_sessions.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    comment='Tracks data import jobs and their metadata, with multi-tenancy.'
    )
    op.create_table('sixr_analysis_parameters',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('analysis_id', sa.UUID(), nullable=False),
    sa.Column('iteration_number', sa.Integer(), nullable=False),
    sa.Column('business_value', sa.Float(), nullable=False),
    sa.Column('technical_complexity', sa.Float(), nullable=False),
    sa.Column('migration_urgency', sa.Float(), nullable=False),
    sa.Column('compliance_requirements', sa.Float(), nullable=False),
    sa.Column('cost_sensitivity', sa.Float(), nullable=False),
    sa.Column('risk_tolerance', sa.Float(), nullable=False),
    sa.Column('innovation_priority', sa.Float(), nullable=False),
    sa.Column('application_type', sa.String(length=20), nullable=True),
    sa.Column('parameter_source', sa.String(length=50), nullable=True),
    sa.Column('confidence_level', sa.Float(), nullable=True),
    sa.Column('created_by', sa.String(length=100), nullable=True),
    sa.Column('updated_by', sa.String(length=100), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('parameter_notes', sa.Text(), nullable=True),
    sa.Column('validation_status', sa.String(length=20), nullable=True),
    sa.ForeignKeyConstraint(['analysis_id'], ['sixr_analyses.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_sixr_analysis_parameters_id'), 'sixr_analysis_parameters', ['id'], unique=False)
    op.create_table('sixr_iterations',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('analysis_id', sa.UUID(), nullable=False),
    sa.Column('iteration_number', sa.Integer(), nullable=False),
    sa.Column('iteration_name', sa.String(length=255), nullable=True),
    sa.Column('iteration_reason', sa.Text(), nullable=True),
    sa.Column('stakeholder_feedback', sa.Text(), nullable=True),
    sa.Column('parameter_changes', sa.JSON(), nullable=True),
    sa.Column('question_responses', sa.JSON(), nullable=True),
    sa.Column('recommendation_data', sa.JSON(), nullable=True),
    sa.Column('confidence_score', sa.Float(), nullable=True),
    sa.Column('analysis_duration', sa.Float(), nullable=True),
    sa.Column('agent_insights', sa.JSON(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('error_details', sa.JSON(), nullable=True),
    sa.Column('created_by', sa.String(length=100), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('completed_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['analysis_id'], ['sixr_analyses.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_sixr_iterations_id'), 'sixr_iterations', ['id'], unique=False)
    op.create_table('sixr_question_responses',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('analysis_id', sa.UUID(), nullable=False),
    sa.Column('iteration_number', sa.Integer(), nullable=False),
    sa.Column('question_id', sa.String(length=100), nullable=False),
    sa.Column('response_value', sa.JSON(), nullable=True),
    sa.Column('response_text', sa.Text(), nullable=True),
    sa.Column('confidence', sa.Float(), nullable=True),
    sa.Column('source', sa.String(length=50), nullable=True),
    sa.Column('response_time', sa.Float(), nullable=True),
    sa.Column('validation_status', sa.String(length=20), nullable=True),
    sa.Column('validation_errors', sa.JSON(), nullable=True),
    sa.Column('created_by', sa.String(length=100), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['analysis_id'], ['sixr_analyses.id'], ),
    sa.ForeignKeyConstraint(['question_id'], ['sixr_questions.question_id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_sixr_question_responses_id'), 'sixr_question_responses', ['id'], unique=False)
    op.create_table('sixr_recommendations',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('analysis_id', sa.UUID(), nullable=False),
    sa.Column('iteration_number', sa.Integer(), nullable=True),
    sa.Column('recommended_strategy', sa.Enum('REHOST', 'REPLATFORM', 'REFACTOR', 'REARCHITECT', 'REWRITE', 'REPLACE', 'RETIRE', name='sixrstrategy'), nullable=False),
    sa.Column('confidence_score', sa.Float(), nullable=False),
    sa.Column('strategy_scores', sa.JSON(), nullable=True),
    sa.Column('key_factors', sa.JSON(), nullable=True),
    sa.Column('assumptions', sa.JSON(), nullable=True),
    sa.Column('next_steps', sa.JSON(), nullable=True),
    sa.Column('estimated_effort', sa.String(length=50), nullable=True),
    sa.Column('estimated_timeline', sa.String(length=100), nullable=True),
    sa.Column('estimated_cost_impact', sa.String(length=50), nullable=True),
    sa.Column('risk_factors', sa.JSON(), nullable=True),
    sa.Column('business_benefits', sa.JSON(), nullable=True),
    sa.Column('technical_benefits', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.Column('created_by', sa.String(length=100), nullable=True),
    sa.ForeignKeyConstraint(['analysis_id'], ['sixr_analyses.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_sixr_recommendations_id'), 'sixr_recommendations', ['id'], unique=False)
    op.create_table('assessments',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('migration_id', sa.UUID(), nullable=False),
    sa.Column('asset_id', sa.UUID(), nullable=True),
    sa.Column('assessment_type', sa.Enum('SIX_R_ANALYSIS', 'RISK_ASSESSMENT', 'COST_ANALYSIS', 'TECHNICAL_ASSESSMENT', 'BUSINESS_IMPACT', 'SECURITY_ASSESSMENT', 'COMPLIANCE_REVIEW', name='assessmenttype'), nullable=False),
    sa.Column('status', sa.Enum('PENDING', 'IN_PROGRESS', 'COMPLETED', 'REVIEWED', 'APPROVED', 'REJECTED', name='assessmentstatus'), nullable=True),
    sa.Column('title', sa.String(length=255), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('overall_score', sa.Float(), nullable=True),
    sa.Column('risk_level', sa.Enum('LOW', 'MEDIUM', 'HIGH', 'CRITICAL', name='risklevel'), nullable=True),
    sa.Column('confidence_level', sa.Float(), nullable=True),
    sa.Column('recommended_strategy', sa.String(length=50), nullable=True),
    sa.Column('alternative_strategies', sa.JSON(), nullable=True),
    sa.Column('strategy_rationale', sa.Text(), nullable=True),
    sa.Column('current_cost', sa.Float(), nullable=True),
    sa.Column('estimated_migration_cost', sa.Float(), nullable=True),
    sa.Column('estimated_target_cost', sa.Float(), nullable=True),
    sa.Column('cost_savings_potential', sa.Float(), nullable=True),
    sa.Column('roi_months', sa.Integer(), nullable=True),
    sa.Column('identified_risks', sa.JSON(), nullable=True),
    sa.Column('risk_mitigation', sa.JSON(), nullable=True),
    sa.Column('blockers', sa.JSON(), nullable=True),
    sa.Column('dependencies_impact', sa.JSON(), nullable=True),
    sa.Column('technical_complexity', sa.String(length=20), nullable=True),
    sa.Column('compatibility_score', sa.Float(), nullable=True),
    sa.Column('modernization_opportunities', sa.JSON(), nullable=True),
    sa.Column('performance_impact', sa.JSON(), nullable=True),
    sa.Column('business_criticality', sa.String(length=20), nullable=True),
    sa.Column('downtime_requirements', sa.JSON(), nullable=True),
    sa.Column('user_impact', sa.Text(), nullable=True),
    sa.Column('compliance_considerations', sa.JSON(), nullable=True),
    sa.Column('ai_insights', sa.JSON(), nullable=True),
    sa.Column('ai_confidence', sa.Float(), nullable=True),
    sa.Column('ai_model_version', sa.String(length=50), nullable=True),
    sa.Column('estimated_effort_hours', sa.Integer(), nullable=True),
    sa.Column('estimated_duration_days', sa.Integer(), nullable=True),
    sa.Column('recommended_wave', sa.Integer(), nullable=True),
    sa.Column('prerequisites', sa.JSON(), nullable=True),
    sa.Column('assessor', sa.String(length=100), nullable=True),
    sa.Column('assessment_date', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('review_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('approval_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['asset_id'], ['assets.id'], ),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['migration_id'], ['migrations.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_assessments_client_account_id'), 'assessments', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_assessments_engagement_id'), 'assessments', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_assessments_id'), 'assessments', ['id'], unique=False)
    op.create_table('asset_dependencies',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('asset_id', sa.UUID(), nullable=False),
    sa.Column('depends_on_asset_id', sa.UUID(), nullable=False),
    sa.Column('dependency_type', sa.String(length=50), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.ForeignKeyConstraint(['asset_id'], ['assets.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['depends_on_asset_id'], ['assets.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('asset_embeddings',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('asset_id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=False),
    sa.Column('engagement_id', sa.UUID(), nullable=False),
    sa.Column('embedding', pgvector.sqlalchemy.vector.VECTOR(dim=1536), nullable=True),
    sa.Column('source_text', sa.Text(), nullable=True),
    sa.Column('embedding_model', sa.String(length=100), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['asset_id'], ['assets.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_asset_embeddings_asset_id'), 'asset_embeddings', ['asset_id'], unique=False)
    op.create_index(op.f('ix_asset_embeddings_client_account_id'), 'asset_embeddings', ['client_account_id'], unique=False)
    op.create_index(op.f('ix_asset_embeddings_engagement_id'), 'asset_embeddings', ['engagement_id'], unique=False)
    op.create_index(op.f('ix_asset_embeddings_id'), 'asset_embeddings', ['id'], unique=False)
    op.create_index(op.f('ix_asset_embeddings_is_mock'), 'asset_embeddings', ['is_mock'], unique=False)
    op.create_table('asset_tags',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('asset_id', sa.UUID(), nullable=False),
    sa.Column('tag_id', sa.UUID(), nullable=False),
    sa.Column('confidence_score', sa.Float(), nullable=True),
    sa.Column('assigned_method', sa.String(length=50), nullable=True),
    sa.Column('assigned_by', sa.UUID(), nullable=True),
    sa.Column('is_validated', sa.Boolean(), nullable=True),
    sa.Column('validated_by', sa.UUID(), nullable=True),
    sa.Column('validated_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['asset_id'], ['assets.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['assigned_by'], ['users.id'], ),
    sa.ForeignKeyConstraint(['tag_id'], ['tags.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['validated_by'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_asset_tags_asset_id'), 'asset_tags', ['asset_id'], unique=False)
    op.create_index(op.f('ix_asset_tags_is_mock'), 'asset_tags', ['is_mock'], unique=False)
    op.create_index(op.f('ix_asset_tags_tag_id'), 'asset_tags', ['tag_id'], unique=False)
    op.create_table('import_field_mappings',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('data_import_id', sa.UUID(), nullable=False),
    sa.Column('source_field', sa.String(length=255), nullable=False),
    sa.Column('target_field', sa.String(length=255), nullable=False),
    sa.Column('mapping_type', sa.String(length=50), nullable=False),
    sa.Column('confidence_score', sa.Float(), nullable=True),
    sa.Column('is_user_defined', sa.Boolean(), nullable=True),
    sa.Column('is_validated', sa.Boolean(), nullable=True),
    sa.Column('validation_method', sa.String(length=50), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('user_feedback', sa.Text(), nullable=True),
    sa.Column('original_ai_suggestion', sa.String(length=255), nullable=True),
    sa.Column('correction_reason', sa.Text(), nullable=True),
    sa.Column('transformation_logic', sa.JSON(), nullable=True),
    sa.Column('validation_rules', sa.JSON(), nullable=True),
    sa.Column('sample_values', sa.JSON(), nullable=True),
    sa.Column('suggested_by', sa.String(length=50), nullable=True),
    sa.Column('validated_by', sa.UUID(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('validated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['data_import_id'], ['data_imports.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['validated_by'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    comment='Manages field mappings for data imports, including AI suggestions and user overrides.'
    )
    op.create_table('import_processing_steps',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('data_import_id', sa.UUID(), nullable=False),
    sa.Column('step_name', sa.String(length=100), nullable=False),
    sa.Column('step_order', sa.Integer(), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('input_data', sa.JSON(), nullable=True),
    sa.Column('output_data', sa.JSON(), nullable=True),
    sa.Column('error_details', sa.JSON(), nullable=True),
    sa.Column('records_processed', sa.Integer(), nullable=True),
    sa.Column('duration_seconds', sa.Float(), nullable=True),
    sa.Column('started_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('completed_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['data_import_id'], ['data_imports.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    comment='Tracks individual processing steps within a data import job for observability.'
    )
    op.create_table('raw_import_records',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('data_import_id', sa.UUID(), nullable=False),
    sa.Column('client_account_id', sa.UUID(), nullable=True),
    sa.Column('engagement_id', sa.UUID(), nullable=True),
    sa.Column('session_id', sa.UUID(), nullable=True),
    sa.Column('row_number', sa.Integer(), nullable=False),
    sa.Column('record_id', sa.String(length=255), nullable=True),
    sa.Column('raw_data', sa.JSON(), nullable=False),
    sa.Column('processed_data', sa.JSON(), nullable=True),
    sa.Column('validation_errors', sa.JSON(), nullable=True),
    sa.Column('processing_notes', sa.Text(), nullable=True),
    sa.Column('is_processed', sa.Boolean(), nullable=True),
    sa.Column('is_valid', sa.Boolean(), nullable=True),
    sa.Column('asset_id', sa.UUID(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('processed_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['asset_id'], ['assets.id'], ),
    sa.ForeignKeyConstraint(['client_account_id'], ['client_accounts.id'], ),
    sa.ForeignKeyConstraint(['data_import_id'], ['data_imports.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['engagement_id'], ['engagements.id'], ),
    sa.ForeignKeyConstraint(['session_id'], ['data_import_sessions.id'], ),
    sa.PrimaryKeyConstraint('id'),
    comment='Stores individual raw data records from imported files before processing.'
    )
    op.create_table('workflow_progress',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('asset_id', sa.UUID(), nullable=False),
    sa.Column('stage', sa.String(length=50), nullable=False),
    sa.Column('status', sa.String(length=50), nullable=False),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('is_mock', sa.Boolean(), nullable=False),
    sa.Column('started_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('completed_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['asset_id'], ['assets.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('data_quality_issues',
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('data_import_id', sa.UUID(), nullable=False),
    sa.Column('raw_record_id', sa.UUID(), nullable=True),
    sa.Column('issue_type', sa.String(length=50), nullable=False),
    sa.Column('field_name', sa.String(length=255), nullable=True),
    sa.Column('current_value', sa.Text(), nullable=True),
    sa.Column('suggested_value', sa.Text(), nullable=True),
    sa.Column('severity', sa.String(length=20), nullable=True),
    sa.Column('confidence_score', sa.Float(), nullable=True),
    sa.Column('reasoning', sa.Text(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('resolution_method', sa.String(length=50), nullable=True),
    sa.Column('resolved_by', sa.UUID(), nullable=True),
    sa.Column('resolution_notes', sa.Text(), nullable=True),
    sa.Column('detected_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('resolved_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['data_import_id'], ['data_imports.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['raw_record_id'], ['raw_import_records.id'], ),
    sa.ForeignKeyConstraint(['resolved_by'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    comment='Tracks data quality issues identified during the import process.'
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('data_quality_issues')
    op.drop_table('workflow_progress')
    op.drop_table('raw_import_records')
    op.drop_table('import_processing_steps')
    op.drop_table('import_field_mappings')
    op.drop_index(op.f('ix_asset_tags_tag_id'), table_name='asset_tags')
    op.drop_index(op.f('ix_asset_tags_is_mock'), table_name='asset_tags')
    op.drop_index(op.f('ix_asset_tags_asset_id'), table_name='asset_tags')
    op.drop_table('asset_tags')
    op.drop_index(op.f('ix_asset_embeddings_is_mock'), table_name='asset_embeddings')
    op.drop_index(op.f('ix_asset_embeddings_id'), table_name='asset_embeddings')
    op.drop_index(op.f('ix_asset_embeddings_engagement_id'), table_name='asset_embeddings')
    op.drop_index(op.f('ix_asset_embeddings_client_account_id'), table_name='asset_embeddings')
    op.drop_index(op.f('ix_asset_embeddings_asset_id'), table_name='asset_embeddings')
    op.drop_table('asset_embeddings')
    op.drop_table('asset_dependencies')
    op.drop_index(op.f('ix_assessments_id'), table_name='assessments')
    op.drop_index(op.f('ix_assessments_engagement_id'), table_name='assessments')
    op.drop_index(op.f('ix_assessments_client_account_id'), table_name='assessments')
    op.drop_table('assessments')
    op.drop_index(op.f('ix_sixr_recommendations_id'), table_name='sixr_recommendations')
    op.drop_table('sixr_recommendations')
    op.drop_index(op.f('ix_sixr_question_responses_id'), table_name='sixr_question_responses')
    op.drop_table('sixr_question_responses')
    op.drop_index(op.f('ix_sixr_iterations_id'), table_name='sixr_iterations')
    op.drop_table('sixr_iterations')
    op.drop_index(op.f('ix_sixr_analysis_parameters_id'), table_name='sixr_analysis_parameters')
    op.drop_table('sixr_analysis_parameters')
    op.drop_table('data_imports')
    op.drop_index(op.f('ix_assets_status'), table_name='assets')
    op.drop_index(op.f('ix_assets_session_id'), table_name='assets')
    op.drop_index(op.f('ix_assets_name'), table_name='assets')
    op.drop_index(op.f('ix_assets_mapping_status'), table_name='assets')
    op.drop_index(op.f('ix_assets_is_mock'), table_name='assets')
    op.drop_index(op.f('ix_assets_id'), table_name='assets')
    op.drop_index(op.f('ix_assets_hostname'), table_name='assets')
    op.drop_index(op.f('ix_assets_environment'), table_name='assets')
    op.drop_index(op.f('ix_assets_engagement_id'), table_name='assets')
    op.drop_index(op.f('ix_assets_client_account_id'), table_name='assets')
    op.drop_index(op.f('ix_assets_asset_type'), table_name='assets')
    op.drop_table('assets')
    op.drop_index(op.f('ix_access_audit_log_user_id'), table_name='access_audit_log')
    op.drop_index(op.f('ix_access_audit_log_id'), table_name='access_audit_log')
    op.drop_index(op.f('ix_access_audit_log_created_at'), table_name='access_audit_log')
    op.drop_index(op.f('ix_access_audit_log_action_type'), table_name='access_audit_log')
    op.drop_table('access_audit_log')
    op.drop_index(op.f('ix_wave_plans_id'), table_name='wave_plans')
    op.drop_index(op.f('ix_wave_plans_engagement_id'), table_name='wave_plans')
    op.drop_index(op.f('ix_wave_plans_client_account_id'), table_name='wave_plans')
    op.drop_table('wave_plans')
    op.drop_index(op.f('ix_user_roles_user_id'), table_name='user_roles')
    op.drop_index(op.f('ix_user_roles_is_active'), table_name='user_roles')
    op.drop_index(op.f('ix_user_roles_id'), table_name='user_roles')
    op.drop_table('user_roles')
    op.drop_index(op.f('ix_soft_deleted_items_status'), table_name='soft_deleted_items')
    op.drop_index(op.f('ix_soft_deleted_items_item_type'), table_name='soft_deleted_items')
    op.drop_index(op.f('ix_soft_deleted_items_item_id'), table_name='soft_deleted_items')
    op.drop_table('soft_deleted_items')
    op.drop_index(op.f('ix_sixr_analyses_name'), table_name='sixr_analyses')
    op.drop_index(op.f('ix_sixr_analyses_id'), table_name='sixr_analyses')
    op.drop_index(op.f('ix_sixr_analyses_engagement_id'), table_name='sixr_analyses')
    op.drop_index(op.f('ix_sixr_analyses_client_account_id'), table_name='sixr_analyses')
    op.drop_table('sixr_analyses')
    op.drop_index(op.f('ix_migration_waves_wave_number'), table_name='migration_waves')
    op.drop_index(op.f('ix_migration_waves_status'), table_name='migration_waves')
    op.drop_index(op.f('ix_migration_waves_is_mock'), table_name='migration_waves')
    op.drop_index(op.f('ix_migration_waves_id'), table_name='migration_waves')
    op.drop_index(op.f('ix_migration_waves_engagement_id'), table_name='migration_waves')
    op.drop_index(op.f('ix_migration_waves_client_account_id'), table_name='migration_waves')
    op.drop_table('migration_waves')
    op.drop_index(op.f('ix_mapping_learning_patterns_target_column'), table_name='mapping_learning_patterns')
    op.drop_index(op.f('ix_mapping_learning_patterns_source_column'), table_name='mapping_learning_patterns')
    op.drop_index(op.f('ix_mapping_learning_patterns_engagement_id'), table_name='mapping_learning_patterns')
    op.drop_table('mapping_learning_patterns')
    op.drop_index('idx_usage_summary_period', table_name='llm_usage_summary')
    op.drop_index('idx_usage_summary_model', table_name='llm_usage_summary')
    op.drop_index('idx_usage_summary_client', table_name='llm_usage_summary')
    op.drop_table('llm_usage_summary')
    op.drop_index('idx_llm_usage_user', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_success', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_reporting', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_provider_model', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_page_context', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_feature_context', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_engagement', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_created_at', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_cost_analysis', table_name='llm_usage_logs')
    op.drop_index('idx_llm_usage_client_account', table_name='llm_usage_logs')
    op.drop_table('llm_usage_logs')
    op.drop_index(op.f('ix_feedback_summaries_page'), table_name='feedback_summaries')
    op.drop_index(op.f('ix_feedback_summaries_id'), table_name='feedback_summaries')
    op.drop_index(op.f('ix_feedback_summaries_feedback_type'), table_name='feedback_summaries')
    op.drop_table('feedback_summaries')
    op.drop_index(op.f('ix_feedback_page'), table_name='feedback')
    op.drop_index(op.f('ix_feedback_id'), table_name='feedback')
    op.drop_index(op.f('ix_feedback_feedback_type'), table_name='feedback')
    op.drop_table('feedback')
    op.drop_index(op.f('ix_enhanced_user_profiles_status'), table_name='enhanced_user_profiles')
    op.drop_index(op.f('ix_enhanced_user_profiles_role_level'), table_name='enhanced_user_profiles')
    op.drop_index(op.f('ix_enhanced_user_profiles_is_deleted'), table_name='enhanced_user_profiles')
    op.drop_index(op.f('ix_enhanced_user_profiles_data_scope'), table_name='enhanced_user_profiles')
    op.drop_table('enhanced_user_profiles')
    op.drop_index(op.f('ix_enhanced_access_audit_log_user_id'), table_name='enhanced_access_audit_log')
    op.drop_index(op.f('ix_enhanced_access_audit_log_created_at'), table_name='enhanced_access_audit_log')
    op.drop_index(op.f('ix_enhanced_access_audit_log_action_type'), table_name='enhanced_access_audit_log')
    op.drop_table('enhanced_access_audit_log')
    op.drop_index(op.f('ix_engagement_access_user_profile_id'), table_name='engagement_access')
    op.drop_index(op.f('ix_engagement_access_is_active'), table_name='engagement_access')
    op.drop_index(op.f('ix_engagement_access_id'), table_name='engagement_access')
    op.drop_index(op.f('ix_engagement_access_engagement_id'), table_name='engagement_access')
    op.drop_table('engagement_access')
    op.drop_index(op.f('ix_data_import_sessions_status'), table_name='data_import_sessions')
    op.drop_index(op.f('ix_data_import_sessions_session_name'), table_name='data_import_sessions')
    op.drop_index(op.f('ix_data_import_sessions_is_mock'), table_name='data_import_sessions')
    op.drop_index(op.f('ix_data_import_sessions_is_default'), table_name='data_import_sessions')
    op.drop_index(op.f('ix_data_import_sessions_id'), table_name='data_import_sessions')
    op.drop_index(op.f('ix_data_import_sessions_engagement_id'), table_name='data_import_sessions')
    op.drop_index(op.f('ix_data_import_sessions_client_account_id'), table_name='data_import_sessions')
    op.drop_table('data_import_sessions')
    op.drop_index(op.f('ix_cmdb_sixr_analyses_status'), table_name='cmdb_sixr_analyses')
    op.drop_index(op.f('ix_cmdb_sixr_analyses_is_mock'), table_name='cmdb_sixr_analyses')
    op.drop_index(op.f('ix_cmdb_sixr_analyses_id'), table_name='cmdb_sixr_analyses')
    op.drop_index(op.f('ix_cmdb_sixr_analyses_engagement_id'), table_name='cmdb_sixr_analyses')
    op.drop_index(op.f('ix_cmdb_sixr_analyses_client_account_id'), table_name='cmdb_sixr_analyses')
    op.drop_table('cmdb_sixr_analyses')
    op.drop_index(op.f('ix_user_account_associations_user_id'), table_name='user_account_associations')
    op.drop_index(op.f('ix_user_account_associations_is_mock'), table_name='user_account_associations')
    op.drop_index(op.f('ix_user_account_associations_client_account_id'), table_name='user_account_associations')
    op.drop_table('user_account_associations')
    op.drop_index(op.f('ix_tags_name'), table_name='tags')
    op.drop_index(op.f('ix_tags_is_mock'), table_name='tags')
    op.drop_index(op.f('ix_tags_is_active'), table_name='tags')
    op.drop_index(op.f('ix_tags_id'), table_name='tags')
    op.drop_index(op.f('ix_tags_client_account_id'), table_name='tags')
    op.drop_index(op.f('ix_tags_category'), table_name='tags')
    op.drop_table('tags')
    op.drop_index(op.f('ix_engagements_status'), table_name='engagements')
    op.drop_index(op.f('ix_engagements_is_mock'), table_name='engagements')
    op.drop_index(op.f('ix_engagements_is_active'), table_name='engagements')
    op.drop_index(op.f('ix_engagements_id'), table_name='engagements')
    op.drop_index(op.f('ix_engagements_client_account_id'), table_name='engagements')
    op.drop_table('engagements')
    op.drop_table('custom_target_fields')
    op.drop_index(op.f('ix_client_access_user_profile_id'), table_name='client_access')
    op.drop_index(op.f('ix_client_access_is_active'), table_name='client_access')
    op.drop_index(op.f('ix_client_access_id'), table_name='client_access')
    op.drop_index(op.f('ix_client_access_client_account_id'), table_name='client_access')
    op.drop_table('client_access')
    op.drop_index(op.f('ix_user_profiles_status'), table_name='user_profiles')
    op.drop_table('user_profiles')
    op.drop_index(op.f('ix_migration_logs_id'), table_name='migration_logs')
    op.drop_table('migration_logs')
    op.drop_index(op.f('ix_client_accounts_slug'), table_name='client_accounts')
    op.drop_index(op.f('ix_client_accounts_is_mock'), table_name='client_accounts')
    op.drop_index(op.f('ix_client_accounts_is_active'), table_name='client_accounts')
    op.drop_index(op.f('ix_client_accounts_id'), table_name='client_accounts')
    op.drop_table('client_accounts')
    op.drop_index(op.f('ix_users_is_mock'), table_name='users')
    op.drop_index(op.f('ix_users_is_active'), table_name='users')
    op.drop_index(op.f('ix_users_id'), table_name='users')
    op.drop_index(op.f('ix_users_email'), table_name='users')
    op.drop_table('users')
    op.drop_index(op.f('ix_sixr_questions_question_id'), table_name='sixr_questions')
    op.drop_index(op.f('ix_sixr_questions_id'), table_name='sixr_questions')
    op.drop_table('sixr_questions')
    op.drop_index(op.f('ix_sixr_parameters_parameter_key'), table_name='sixr_parameters')
    op.drop_table('sixr_parameters')
    op.drop_index(op.f('ix_role_permissions_role_level'), table_name='role_permissions')
    op.drop_table('role_permissions')
    op.drop_index(op.f('ix_migrations_name'), table_name='migrations')
    op.drop_index(op.f('ix_migrations_id'), table_name='migrations')
    op.drop_table('migrations')
    op.drop_index('idx_model_pricing_provider_model', table_name='llm_model_pricing')
    op.drop_index('idx_model_pricing_active', table_name='llm_model_pricing')
    op.drop_table('llm_model_pricing')
    # ### end Alembic commands ### 