"""
Secure Cache Service with Field-Level Encryption

This service provides field-level encryption for sensitive cached data while maintaining
multi-tenant isolation and performance. It integrates with the existing Redis cache
infrastructure and provides transparent encryption/decryption.

ðŸ”’ Security: Field-level encryption, tenant isolation, key rotation, integrity checks
âš¡ Performance: Selective encryption, optimized key management, minimal overhead
ðŸŽ¯ Coherence: Integrates with cache invalidation, preserves cache coherence
ðŸ“Š Analytics: Encryption metrics, security audit logs, performance tracking

Modularized structure:
- config.py: Encryption configuration and field patterns
- encoder.py: Encryption/decryption logic with performance tracking
- service.py: Main service class with Redis integration

Generated by CC (Claude Code)
"""

# Import all components for backward compatibility
from .config import EncryptionLevel, FieldEncryptionConfig
from .encoder import SecureCacheEncoder
from .service import SecureCacheService

# Import dependencies for factory function
from app.services.caching.redis_cache import RedisCache


# Factory function for dependency injection (backward compatibility)
def get_secure_cache_service(redis_cache: RedisCache = None) -> SecureCacheService:
    """
    Factory function to create SecureCacheService with dependencies.
    """
    if redis_cache is None:
        from app.services.caching.redis_cache import get_redis_cache

        redis_cache = get_redis_cache()

    return SecureCacheService(redis_cache)


# Maintain exact same exports as original file for 100% backward compatibility
__all__ = [
    "SecureCacheService",
    "SecureCacheEncoder",
    "FieldEncryptionConfig",
    "EncryptionLevel",
    "get_secure_cache_service",
]
