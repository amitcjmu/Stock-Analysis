"""
Secure Cache Configuration

Configuration classes and enums for field-level encryption in the secure cache service.
Defines encryption levels, field patterns, and encryption policies.

Generated by CC (Claude Code)
"""

from enum import Enum
from typing import Optional


class EncryptionLevel(Enum):
    """Encryption levels for different types of data."""

    NONE = "none"  # No encryption
    BASIC = "basic"  # Basic encryption for non-sensitive data
    SENSITIVE = "sensitive"  # Strong encryption for PII/sensitive data
    HIGHLY_SENSITIVE = "highly_sensitive"  # Strongest encryption for critical data


class FieldEncryptionConfig:
    """
    Configuration for field-level encryption.
    Defines which fields should be encrypted and at what level.
    """

    # Field patterns that should be encrypted
    ENCRYPTION_PATTERNS = {
        # PII fields - highly sensitive
        "email": EncryptionLevel.HIGHLY_SENSITIVE,
        "ssn": EncryptionLevel.HIGHLY_SENSITIVE,
        "tax_id": EncryptionLevel.HIGHLY_SENSITIVE,
        "phone": EncryptionLevel.SENSITIVE,
        "address": EncryptionLevel.SENSITIVE,
        # User data - sensitive
        "password": EncryptionLevel.HIGHLY_SENSITIVE,
        "username": EncryptionLevel.BASIC,
        "full_name": EncryptionLevel.SENSITIVE,
        "first_name": EncryptionLevel.SENSITIVE,
        "last_name": EncryptionLevel.SENSITIVE,
        # API keys and credentials - highly sensitive
        "api_key": EncryptionLevel.HIGHLY_SENSITIVE,
        "secret": EncryptionLevel.HIGHLY_SENSITIVE,
        "token": EncryptionLevel.HIGHLY_SENSITIVE,
        "password_hash": EncryptionLevel.HIGHLY_SENSITIVE,
        # Database connection strings and credentials
        "connection_string": EncryptionLevel.HIGHLY_SENSITIVE,
        "database_password": EncryptionLevel.HIGHLY_SENSITIVE,
        # Field mapping patterns that might contain sensitive column names
        "source_field": EncryptionLevel.BASIC,
        "target_field": EncryptionLevel.BASIC,
        "field_description": EncryptionLevel.BASIC,
    }

    @classmethod
    def should_encrypt_field(cls, field_name: str) -> Optional[EncryptionLevel]:
        """
        Determine if a field should be encrypted and at what level.

        Args:
            field_name: Name of the field to check

        Returns:
            EncryptionLevel if field should be encrypted, None otherwise
        """
        field_lower = field_name.lower()

        # Check exact matches first
        if field_lower in cls.ENCRYPTION_PATTERNS:
            return cls.ENCRYPTION_PATTERNS[field_lower]

        # Check partial matches
        for pattern, level in cls.ENCRYPTION_PATTERNS.items():
            if pattern in field_lower or field_lower.endswith(pattern):
                return level

        # Check for common sensitive patterns
        sensitive_indicators = ["secret", "password", "key", "token", "credential"]
        if any(indicator in field_lower for indicator in sensitive_indicators):
            return EncryptionLevel.HIGHLY_SENSITIVE

        return None


__all__ = ["EncryptionLevel", "FieldEncryptionConfig"]
