"""
VMware-specific data transformation logic.

Generated by CC (Claude Code)
"""

import logging
from typing import Any, Dict

logger = logging.getLogger(__name__)


class VMwareTransformer:
    """Transformer for VMware-specific data formats."""

    def transform(self, data: Dict[str, Any]) -> Dict[str, Any]:
        """Transform VMware specific data formats."""
        transformed = {}

        for key, value in data.items():
            # Convert VMware memory values (usually in MB) to GB
            if key in ["memorySizeMB", "memory_size_mb"] and isinstance(
                value, (int, float)
            ):
                transformed["memory_gb"] = round(value / 1024, 2)
            # Handle VMware MoRef IDs
            elif key == "vm" and isinstance(value, dict) and "_moId" in value:
                transformed["vm_id"] = value["_moId"]
            else:
                transformed[key] = value

        return transformed
