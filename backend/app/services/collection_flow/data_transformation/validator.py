"""
Data validation logic.

Generated by CC (Claude Code)
"""

import logging
from typing import Any, Dict, List

from .base import DataType

logger = logging.getLogger(__name__)


class DataValidator:
    """Validates transformed data for completeness and correctness."""

    def validate_transformed_data(
        self, data: Dict[str, Any], data_type: DataType
    ) -> List[str]:
        """Validate transformed data for completeness and correctness."""
        errors = []

        # Define required fields by data type
        required_fields = {
            DataType.SERVER: ["hostname", "ip_address", "operating_system"],
            DataType.APPLICATION: ["app_name", "version"],
            DataType.DATABASE: ["db_name", "db_type", "host"],
        }

        # Check required fields
        if data_type in required_fields:
            for field in required_fields[data_type]:
                if field not in data or not data[field]:
                    errors.append(f"Required field '{field}' is missing or empty")

        # Validate field formats
        if "ip_address" in data:
            if not self._is_valid_ip(data["ip_address"]):
                errors.append(f"Invalid IP address format: {data['ip_address']}")

        if "memory_gb" in data:
            try:
                memory = float(data["memory_gb"])
                if memory < 0:
                    errors.append("Memory value cannot be negative")
            except (ValueError, TypeError):
                errors.append(f"Invalid memory value: {data['memory_gb']}")

        return errors

    def _is_valid_ip(self, ip: str) -> bool:
        """Validate IP address format."""
        try:
            parts = ip.split(".")
            return len(parts) == 4 and all(0 <= int(part) <= 255 for part in parts)
        except (ValueError, AttributeError):
            return False
