"""
User Context Cache Key Patterns

Cache key generation for user-related data including context, clients,
engagements, and user preferences.

Generated by CC (Claude Code)
"""

from .base import BaseCacheKeys, CACHE_VERSION


class UserCacheKeys(BaseCacheKeys):
    """
    Cache key patterns for user context and preferences.

    Handles user authentication context, accessible clients/engagements,
    active flows, and user default settings.
    """

    @staticmethod
    def user_context(user_id: str) -> str:
        """
        Cache key for complete user context (client, engagement, permissions).
        TTL: 1 hour (context rarely changes)
        Invalidation: on user role changes, client/engagement assignments
        """
        return f"{CACHE_VERSION}:user:context:{user_id}"

    @staticmethod
    def user_clients(user_id: str) -> str:
        """
        Cache key for user's accessible client accounts.
        TTL: 30 minutes
        Invalidation: on user-client association changes
        """
        return f"{CACHE_VERSION}:user:{user_id}:clients"

    @staticmethod
    def user_engagements(user_id: str, client_id: str) -> str:
        """
        Cache key for user's accessible engagements within a client.
        TTL: 30 minutes
        Invalidation: on engagement creation/deletion, user permissions
        """
        return f"{CACHE_VERSION}:user:{user_id}:client:{client_id}:engagements"

    @staticmethod
    def user_active_flows(user_id: str, client_id: str, engagement_id: str) -> str:
        """
        Cache key for user's active flows in an engagement.
        TTL: 5 minutes (flows change frequently)
        Invalidation: on flow state changes
        """
        return f"{CACHE_VERSION}:user:{user_id}:client:{client_id}:engagement:{engagement_id}:active_flows"

    @staticmethod
    def user_defaults(user_id: str) -> str:
        """
        Cache key for user's default client/engagement settings.
        TTL: 2 hours
        Invalidation: on user defaults update
        """
        return f"{CACHE_VERSION}:user:{user_id}:defaults"
