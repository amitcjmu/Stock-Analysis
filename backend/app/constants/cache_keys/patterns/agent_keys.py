"""
Agent Execution Cache Key Patterns

Cache key generation for agent execution including analysis results,
learning patterns, and crew execution state.

Generated by CC (Claude Code)
"""

from .base import BaseCacheKeys, CACHE_VERSION


class AgentCacheKeys(BaseCacheKeys):
    """
    Cache key patterns for agent execution and results.

    Handles agent analysis results, learning patterns, and
    CrewAI execution state management.
    """

    @staticmethod
    def agent_analysis_results(agent_type: str, entity_id: str, client_id: str) -> str:
        """
        Cache key for agent analysis results on entities.
        TTL: varies by agent type and data volatility
        Invalidation: on entity changes, re-analysis
        """
        return f"{CACHE_VERSION}:client:{client_id}:agent:{agent_type}:analysis:{entity_id}"

    @staticmethod
    def agent_learning_patterns(agent_type: str, client_id: str) -> str:
        """
        Cache key for agent learning patterns specific to a client.
        TTL: 24 hours
        Invalidation: on learning model updates
        """
        return (
            f"{CACHE_VERSION}:client:{client_id}:agent:{agent_type}:learning_patterns"
        )

    @staticmethod
    def crew_execution_state(crew_id: str, flow_id: str, client_id: str) -> str:
        """
        Cache key for CrewAI execution state and progress.
        TTL: 1 minute (highly dynamic)
        Invalidation: on crew state changes
        """
        return f"{CACHE_VERSION}:client:{client_id}:crew:{crew_id}:flow:{flow_id}:state"

    @staticmethod
    def agent_result(
        agent_id: str,
        agent_name: str,
        flow_id: str,
        client_account_id: str,
        engagement_id: str,
    ) -> str:
        """
        Cache key for agent execution results.
        TTL: varies by agent type (see AgentCacheStrategy)
        Invalidation: on agent re-execution, flow reset
        """
        return (
            f"{CACHE_VERSION}:client:{client_account_id}:engagement:{engagement_id}:"
            f"agent:{agent_name}:flow:{flow_id}:result:{agent_id}"
        )
