/**
 * Planning Flow Management Types
 * 
 * Core type definitions for planning flow initialization, status management,
 * and lifecycle operations. Contains the foundational types and APIs for
 * managing migration planning workflows.
 * 
 * Generated by CC - Claude Code
 */

import {
  BaseApiRequest,
  BaseApiResponse,
  MultiTenantContext,
  ListRequest,
  ListResponse,
  GetRequest,
  GetResponse,
  UpdateRequest,
  UpdateResponse
} from '../shared';

// Planning Flow Management APIs
export interface InitializePlanningFlowRequest extends BaseApiRequest {
  flowName: string;
  flowDescription?: string;
  context: MultiTenantContext;
  planningScope: PlanningScope;
  assessmentInputs: AssessmentInput[];
  targetArchitecture: TargetArchitecture;
  constraints: PlanningConstraint[];
  objectives: PlanningObjective[];
  parentFlowId?: string;
  configuration?: PlanningFlowConfiguration;
  template?: string;
  metadata?: Record<string, any>;
}

export interface InitializePlanningFlowResponse extends BaseApiResponse<PlanningFlowData> {
  data: PlanningFlowData;
  flowId: string;
  initialState: PlanningState;
  planningFramework: PlanningFramework;
  nextSteps: string[];
  recommendations?: string[];
}

export interface GetPlanningFlowStatusRequest extends GetRequest {
  flowId: string;
  includeDetails?: boolean;
  includeTimeline?: boolean;
  includeResources?: boolean;
  includeRisks?: boolean;
  includeCosts?: boolean;
  includeDeliverables?: boolean;
}

export interface GetPlanningFlowStatusResponse extends BaseApiResponse<PlanningStatusDetail> {
  data: PlanningStatusDetail;
  timeline: PlanningTimeline;
  resources: ResourcePlan;
  risks: RiskRegister;
  costs: CostPlan;
  realTimeUpdates?: boolean;
  nextRefresh?: string;
}

export interface ListPlanningFlowsRequest extends ListRequest {
  planningTypes?: string[];
  status?: PlanningStatus[];
  priorities?: string[];
  complexityLevels?: string[];
  clientAccountIds?: string[];
  engagementIds?: string[];
  dateRange?: {
    start: string;
    end: string;
    field: 'created' | 'updated' | 'completed' | 'planned_start' | 'planned_end';
  };
  includeArchived?: boolean;
  includeMetrics?: boolean;
  includeCosts?: boolean;
}

export interface ListPlanningFlowsResponse extends ListResponse<PlanningFlowSummary> {
  data: PlanningFlowSummary[];
  aggregations?: PlanningAggregation[];
  trends?: PlanningTrend[];
  portfolioMetrics?: PortfolioMetrics;
}

export interface UpdatePlanningFlowRequest extends UpdateRequest<Partial<PlanningFlowData>> {
  flowId: string;
  data: Partial<PlanningFlowData>;
  validateDependencies?: boolean;
  recalculateTimeline?: boolean;
  updateResourceAllocation?: boolean;
  updateCosts?: boolean;
  propagateChanges?: boolean;
}

export interface UpdatePlanningFlowResponse extends UpdateResponse<PlanningFlowData> {
  data: PlanningFlowData;
  impactAnalysis?: ChangeImpactAnalysis;
  timelineUpdates?: TimelineUpdate[];
  resourceUpdates?: ResourceUpdate[];
  costUpdates?: CostUpdate[];
}

// Core Data Types
export interface PlanningFlowData {
  id: string;
  flowId: string;
  flowName: string;
  flowDescription?: string;
  planningType: string;
  status: PlanningStatus;
  priority: 'low' | 'medium' | 'high' | 'critical';
  scope: PlanningScope;
  progress: number;
  phases: PlanningPhases;
  currentPhase: string;
  targetArchitecture: TargetArchitecture;
  constraints: PlanningConstraint[];
  objectives: PlanningObjective[];
  clientAccountId: string;
  engagementId: string;
  userId: string;
  createdAt: string;
  updatedAt: string;
  completedAt?: string;
  approvedAt?: string;
  metadata: Record<string, any>;
}

export interface PlanningScope {
  applications: string[];
  infrastructure: string[];
  data: string[];
  processes: string[];
  geography: string[];
  businessUnits: string[];
  timeframe: {
    start: string;
    end: string;
  };
  budget: {
    min: number;
    max: number;
    currency: string;
  };
  resources: {
    internal: number;
    external: number;
    skills: string[];
  };
  exclusions?: string[];
  assumptions?: string[];
}

export interface PlanningFlowConfiguration {
  methodology: 'agile' | 'waterfall' | 'hybrid' | 'lean' | 'devops';
  governanceFramework: string;
  qualityStandards: string[];
  riskManagement: boolean;
  changeManagement: boolean;
  communicationProtocols: string[];
  reportingFrequency: string;
  approvalGates: string[];
  integrations: IntegrationConfig[];
  automation: AutomationConfig[];
}

export interface PlanningState {
  flowId: string;
  currentPhase: string;
  nextPhase?: string;
  phaseCompletion: Record<string, boolean>;
  phaseResults: Record<string, any>;
  planningArtifacts: Record<string, any>;
  approvalStatus: Record<string, string>;
  riskStatus: RiskStatus;
  resourceStatus: ResourceStatus;
  timelineStatus: TimelineStatus;
  costStatus: CostStatus;
  qualityStatus: QualityStatus;
  blockers: PlanningBlocker[];
  dependencies: PlanningDependency[];
  assumptions: PlanningAssumption[];
  decisions: PlanningDecision[];
  createdAt: string;
  updatedAt: string;
}

export type PlanningStatus = 
  | 'initiation' | 'strategy_development' | 'timeline_planning' 
  | 'resource_planning' | 'risk_planning' | 'cost_planning' 
  | 'execution_planning' | 'validation' | 'approval' 
  | 'approved' | 'rejected' | 'on_hold' | 'cancelled';

// Supporting Types
export interface AssessmentInput {
  id: string;
  type: string;
  source: string;
  data: Record<string, any>;
  confidence: number;
  timestamp: string;
}

export interface TargetArchitecture {
  id: string;
  name: string;
  description: string;
  components: ArchitectureComponent[];
  patterns: ArchitecturePattern[];
  principles: string[];
  standards: string[];
}

export interface PlanningConstraint {
  id: string;
  type: 'time' | 'budget' | 'resource' | 'technical' | 'regulatory' | 'business';
  description: string;
  value: any;
  priority: 'low' | 'medium' | 'high' | 'critical';
  impact: string;
}

export interface PlanningObjective {
  id: string;
  name: string;
  description: string;
  category: string;
  priority: number;
  measurable: boolean;
  metrics: ObjectiveMetric[];
  targetValue: any;
  currentValue?: any;
}

// Additional supporting interfaces
export interface PlanningFramework {
  name: string;
  version: string;
  methodology: string;
  phases: string[];
  deliverables: string[];
  roles: string[];
}

export interface PlanningStatusDetail {
  id: string;
  flowId: string;
  status: PlanningStatus;
  progress: number;
  health: 'healthy' | 'warning' | 'critical';
  lastUpdate: string;
  nextMilestone: string;
}

export interface PlanningFlowSummary {
  id: string;
  flowId: string;
  name: string;
  type: string;
  status: PlanningStatus;
  priority: string;
  progress: number;
  createdAt: string;
  updatedAt: string;
}

export interface PlanningAggregation {
  field: string;
  value: string;
  count: number;
  percentage: number;
}

export interface PlanningTrend {
  metric: string;
  period: string;
  values: number[];
  trend: 'increasing' | 'decreasing' | 'stable';
}

export interface PortfolioMetrics {
  totalFlows: number;
  activeFlows: number;
  completedFlows: number;
  averageProgress: number;
  budgetUtilization: number;
  resourceUtilization: number;
}

export interface ChangeImpactAnalysis {
  scope: string;
  severity: 'low' | 'medium' | 'high' | 'critical';
  affectedAreas: string[];
  estimatedEffort: number;
  riskLevel: string;
  recommendations: string[];
}

export interface TimelineUpdate {
  type: 'task' | 'milestone' | 'phase';
  id: string;
  change: 'added' | 'modified' | 'removed' | 'delayed';
  impact: string;
  newDate?: string;
}

export interface ResourceUpdate {
  type: 'allocation' | 'skill' | 'availability';
  resourceId: string;
  change: string;
  impact: string;
  newAllocation?: number;
}

export interface CostUpdate {
  type: 'budget' | 'actual' | 'forecast';
  category: string;
  change: number;
  impact: string;
  reason: string;
}

// Status Types
export interface RiskStatus {
  level: 'low' | 'medium' | 'high' | 'critical';
  count: number;
  trending: 'improving' | 'stable' | 'deteriorating';
}

export interface ResourceStatus {
  utilization: number;
  availability: number;
  conflicts: number;
  trending: 'improving' | 'stable' | 'deteriorating';
}

export interface TimelineStatus {
  onTrack: boolean;
  variance: number;
  criticalPath: boolean;
  trending: 'improving' | 'stable' | 'deteriorating';
}

export interface CostStatus {
  budgetVariance: number;
  forecastAccuracy: number;
  trending: 'improving' | 'stable' | 'deteriorating';
}

export interface QualityStatus {
  score: number;
  gatesPassed: number;
  totalGates: number;
  trending: 'improving' | 'stable' | 'deteriorating';
}

// Additional supporting types
export interface PlanningBlocker {
  id: string;
  type: string;
  description: string;
  severity: 'low' | 'medium' | 'high' | 'critical';
  owner: string;
  status: 'open' | 'in_progress' | 'resolved';
  createdAt: string;
}

export interface PlanningDependency {
  id: string;
  type: 'predecessor' | 'successor' | 'external';
  dependentId: string;
  description: string;
  status: 'pending' | 'active' | 'satisfied' | 'blocked';
}

export interface PlanningAssumption {
  id: string;
  description: string;
  category: string;
  confidence: number;
  validatedAt?: string;
  owner: string;
}

export interface PlanningDecision {
  id: string;
  title: string;
  description: string;
  options: string[];
  selectedOption: string;
  rationale: string;
  decidedBy: string;
  decidedAt: string;
}

export interface PlanningPhases {
  [phaseName: string]: {
    status: 'not_started' | 'in_progress' | 'completed' | 'blocked';
    progress: number;
    startDate?: string;
    endDate?: string;
    deliverables: string[];
  };
}

export interface ArchitectureComponent {
  id: string;
  name: string;
  type: string;
  description: string;
  dependencies: string[];
}

export interface ArchitecturePattern {
  id: string;
  name: string;
  type: string;
  description: string;
  applicability: string[];
}

export interface ObjectiveMetric {
  name: string;
  unit: string;
  baseline: number;
  target: number;
  current?: number;
}

export interface IntegrationConfig {
  service: string;
  endpoint: string;
  authentication: string;
  settings: Record<string, any>;
}

export interface AutomationConfig {
  trigger: string;
  action: string;
  conditions: Record<string, any>;
  settings: Record<string, any>;
}

// Additional placeholder types for cross-references
export interface PlanningTimeline {
  id: string;
  name: string;
  startDate: string;
  endDate: string;
  phases: any[];
}

export interface ResourcePlan {
  id: string;
  name: string;
  resources: any[];
  utilization: number;
}

export interface RiskRegister {
  id: string;
  risks: any[];
  totalRisks: number;
  highRisks: number;
}

export interface CostPlan {
  id: string;
  totalBudget: number;
  actualCost: number;
  forecastCost: number;
}