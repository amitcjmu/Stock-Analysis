/**
 * FinOps Flow Management Types
 * 
 * Type definitions for FinOps flow initialization, status tracking, and lifecycle management.
 * Covers flow creation, state management, and monitoring operations.
 * 
 * Generated by CC (Claude Code) - Modularized from finops.ts
 */

import {
  BaseApiRequest,
  BaseApiResponse,
  MultiTenantContext,
  ListRequest,
  ListResponse,
  GetRequest,
  GetResponse
} from '../shared';

// FinOps Flow Management APIs
export interface InitializeFinOpsFlowRequest extends BaseApiRequest {
  flowName: string;
  flowDescription?: string;
  context: MultiTenantContext;
  finOpsScope: FinOpsScope;
  objectives: FinOpsObjective[];
  constraints: FinOpsConstraint[];
  governanceFramework: FinOpsGovernance;
  parentFlowId?: string;
  configuration?: FinOpsFlowConfiguration;
  metadata?: Record<string, any>;
}

export interface InitializeFinOpsFlowResponse extends BaseApiResponse<FinOpsFlowData> {
  data: FinOpsFlowData;
  flowId: string;
  initialState: FinOpsState;
  recommendedActions: FinOpsAction[];
  costBaseline: CostBaseline;
  optimizationOpportunities: OptimizationOpportunity[];
}

export interface GetFinOpsFlowStatusRequest extends GetRequest {
  flowId: string;
  includeDetails?: boolean;
  includeCostAnalysis?: boolean;
  includeOptimizations?: boolean;
  includeBudgetStatus?: boolean;
  includeForecasts?: boolean;
  includeAlerts?: boolean;
}

export interface GetFinOpsFlowStatusResponse extends BaseApiResponse<FinOpsStatusDetail> {
  data: FinOpsStatusDetail;
  costAnalysis: CostAnalysis;
  optimizations: ActiveOptimization[];
  budgetStatus: BudgetStatus;
  forecasts: CostForecast[];
  alerts: FinOpsAlert[];
}

export interface ListFinOpsFlowsRequest extends ListRequest {
  finOpsTypes?: string[];
  status?: FinOpsStatus[];
  costCategories?: string[];
  optimizationTypes?: string[];
  clientAccountIds?: string[];
  engagementIds?: string[];
  dateRange?: {
    start: string;
    end: string;
    field: 'created' | 'updated' | 'cost_period_start' | 'cost_period_end';
  };
  includeArchived?: boolean;
  includeMetrics?: boolean;
}

export interface ListFinOpsFlowsResponse {
  data: FinOpsFlowSummary[];
  total: number;
  page: number;
  pageSize: number;
  hasMore: boolean;
  aggregations?: FinOpsAggregation[];
  trends?: FinOpsTrend[];
  benchmarks?: FinOpsBenchmark[];
  portfolioMetrics?: FinOpsPortfolioMetrics;
}

// Supporting Data Types
export interface FinOpsFlowData {
  id: string;
  flowId: string;
  flowName: string;
  flowDescription?: string;
  finOpsType: string;
  status: FinOpsStatus;
  priority: 'low' | 'medium' | 'high' | 'critical';
  scope: FinOpsScope;
  objectives: FinOpsObjective[];
  constraints: FinOpsConstraint[];
  governance: FinOpsGovernance;
  progress: number;
  phases: FinOpsPhases;
  currentPhase: string;
  clientAccountId: string;
  engagementId: string;
  userId: string;
  createdAt: string;
  updatedAt: string;
  completedAt?: string;
  metadata: Record<string, any>;
}

export interface FinOpsScope {
  accounts: string[];
  services: string[];
  resources: string[];
  regions: string[];
  costCenters: string[];
  projects: string[];
  environments: string[];
  timeframe: {
    start: string;
    end: string;
  };
  budget: {
    amount: number;
    currency: string;
  };
  exclusions?: string[];
  tags?: Record<string, string>;
}

export interface FinOpsObjective {
  id: string;
  name: string;
  description: string;
  type: 'cost_reduction' | 'budget_compliance' | 'resource_optimization' | 'governance';
  target: ObjectiveTarget;
  priority: number;
  deadline?: string;
  measurable: boolean;
  kpis: string[];
}

export interface FinOpsConstraint {
  id: string;
  type: 'budget' | 'performance' | 'compliance' | 'operational';
  description: string;
  value: unknown;
  operator: string;
  mandatory: boolean;
  exceptions?: string[];
}

export interface FinOpsGovernance {
  framework: string;
  policies: string[];
  approvalWorkflows: ApprovalWorkflow[];
  complianceRequirements: string[];
  auditFrequency: string;
  reportingCadence: string;
  stakeholders: Stakeholder[];
  escalationPaths: EscalationPath[];
}

export interface FinOpsFlowConfiguration {
  automation: FinOpsAutomation;
  monitoring: FinOpsMonitoring;
  alerting: FinOpsAlerting;
  reporting: FinOpsReporting;
  optimization: FinOpsOptimization;
  governance: FinOpsGovernanceConfig;
  integration: FinOpsIntegration;
}

export interface FinOpsState {
  flowId: string;
  status: FinOpsStatus;
  currentPhase: string;
  phaseStates: Record<string, PhaseState>;
  costBaseline: CostBaseline;
  budgetStatus: BudgetStatus;
  optimizationStatus: OptimizationStatus;
  governanceStatus: GovernanceStatus;
  kpis: FinOpsKPI[];
  alerts: FinOpsAlert[];
  recommendations: FinOpsRecommendation[];
  decisions: FinOpsDecision[];
  createdAt: string;
  updatedAt: string;
}

export type FinOpsStatus = 
  | 'planning' | 'baseline_analysis' | 'budget_setup' | 'optimization_identification'
  | 'implementation' | 'monitoring' | 'governance' | 'reporting'
  | 'completed' | 'paused' | 'failed' | 'cancelled';

// Forward declarations for types used from other modules
export interface FinOpsAction { [key: string]: unknown; }
export interface OptimizationOpportunity { [key: string]: unknown; }
export interface CostBaseline { [key: string]: unknown; }
export interface FinOpsStatusDetail { [key: string]: unknown; }
export interface CostAnalysis { [key: string]: unknown; }
export interface ActiveOptimization { [key: string]: unknown; }
export interface BudgetStatus { [key: string]: unknown; }
export interface CostForecast { [key: string]: unknown; }
export interface FinOpsAlert {
  id: string;
  type: string;
  severity: string;
  message: string;
  triggeredAt: string;
}
export interface FinOpsFlowSummary {
  id: string;
  name: string;
  status: string;
  progress: number;
  cost: unknown;
}
export interface FinOpsAggregation {
  name: string;
  type: string;
  field: string;
  value: unknown;
}
export interface FinOpsTrend {
  metric: string;
  direction: string;
  value: number;
}
export interface FinOpsBenchmark {
  metric: string;
  value: number;
  percentile: number;
}
export interface FinOpsPortfolioMetrics { [key: string]: unknown; }
export interface ObjectiveTarget { [key: string]: unknown; }
export interface ApprovalWorkflow { [key: string]: unknown; }
export interface Stakeholder { [key: string]: unknown; }
export interface EscalationPath { [key: string]: unknown; }
export interface FinOpsAutomation { [key: string]: unknown; }
export interface FinOpsMonitoring { [key: string]: unknown; }
export interface FinOpsAlerting { [key: string]: unknown; }
export interface FinOpsReporting { [key: string]: unknown; }
export interface FinOpsOptimization { [key: string]: unknown; }
export interface FinOpsGovernanceConfig { [key: string]: unknown; }
export interface FinOpsIntegration { [key: string]: unknown; }
export interface PhaseState { [key: string]: unknown; }
export interface OptimizationStatus { [key: string]: unknown; }
export interface GovernanceStatus { [key: string]: unknown; }
export interface FinOpsKPI { [key: string]: unknown; }
export interface FinOpsRecommendation { [key: string]: unknown; }
export interface FinOpsDecision { [key: string]: unknown; }
export interface FinOpsPhases { [key: string]: unknown; }