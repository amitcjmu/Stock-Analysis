/**
 * FinOps Shared Utilization Types
 * 
 * Common type definitions for resource utilization, performance monitoring,
 * and efficiency analysis shared across FinOps modules.
 * 
 * Generated by CC (Claude Code) - FinOps Type Modularization
 */

import { CostAmount } from '../cost-analysis';
import { PerformanceMetric, TrendDirection } from './base-types';

// Utilization Core Types
export interface UtilizationMetric {
  name: string;
  type: 'cpu' | 'memory' | 'disk' | 'network' | 'iops' | 'bandwidth' | 'custom';
  aggregation: 'avg' | 'max' | 'min' | 'p95' | 'p99';
  unit: string;
  target?: number;
}

export interface UtilizationThreshold {
  metric: string;
  underutilized: number;
  overutilized: number;
  optimal: {
    min: number;
    max: number;
  };
  critical?: number;
}

export interface UtilizationMetricValue {
  metric: string;
  current: number;
  average: number;
  peak: number;
  minimum: number;
  trend: TrendDirection;
  threshold: UtilizationThreshold;
}

export interface ResourceUtilization {
  metrics: UtilizationMetricValue[];
  overallScore: number;
  category: 'underutilized' | 'optimal' | 'overutilized' | 'unknown';
  patterns: UtilizationPattern[];
  peaks: UtilizationPeak[];
}

export interface UtilizationPattern {
  type: 'daily' | 'weekly' | 'monthly' | 'seasonal' | 'irregular';
  description: string;
  confidence: number;
  predictability: number;
}

export interface UtilizationPeak {
  timestamp: string;
  duration: string;
  metrics: Record<string, number>;
  trigger: string;
  frequency: 'rare' | 'occasional' | 'regular' | 'constant';
}

export interface UtilizationSummary {
  totalResources: number;
  underutilizedCount: number;
  overutilizedCount: number;
  optimalCount: number;
  averageUtilization: Record<string, number>;
  totalCost: CostAmount;
  potentialSavings: CostAmount;
  efficiency: ResourceEfficiency;
}

export interface ResourceEfficiency {
  overall: number;
  byType: Record<string, number>;
  byRegion: Record<string, number>;
  byProject: Record<string, number>;
  trend: 'improving' | 'degrading' | 'stable';
}

// Performance Analysis Types
export interface ResourcePerformance {
  latency: PerformanceMetric;
  throughput: PerformanceMetric;
  availability: PerformanceMetric;
  errorRate: PerformanceMetric;
  customMetrics: PerformanceMetric[];
  slaCompliance: SLACompliance;
}

export interface SLACompliance {
  overall: number;
  metrics: SLAMetricCompliance[];
  violations: SLAViolation[];
  riskLevel: 'low' | 'medium' | 'high';
}

export interface SLAMetricCompliance {
  metric: string;
  target: number;
  actual: number;
  compliance: number;
  status: 'compliant' | 'at_risk' | 'violated';
}

export interface SLAViolation {
  metric: string;
  timestamp: string;
  duration: string;
  severity: 'minor' | 'major' | 'critical';
  impact: string;
}

// Trend and Anomaly Detection Types
export interface UtilizationTrend {
  resourceId: string;
  metric: string;
  direction: TrendDirection;
  rate: number;
  confidence: number;
  timeframe: string;
  projectedImpact: string;
}

export interface UtilizationAnomaly {
  resourceId: string;
  metric: string;
  timestamp: string;
  type: 'spike' | 'drop' | 'pattern_change' | 'outlier';
  severity: 'low' | 'medium' | 'high';
  deviation: number;
  possibleCauses: string[];
  impact: string;
}

// Capacity Planning Types
export interface CapacityMetric {
  name: string;
  current: number;
  maximum: number;
  reserved: number;
  available: number;
  unit: string;
  utilizationRate: number;
  growthRate: number;
}

export interface CapacityForecast {
  metric: string;
  timeHorizon: string;
  projectedDemand: number;
  recommendedCapacity: number;
  confidence: number;
  assumptions: string[];
  riskFactors: string[];
}

export interface CapacityPlan {
  resources: CapacityResource[];
  timeline: CapacityTimeline[];
  costs: CapacityCost[];
  risks: CapacityRisk[];
  alternatives: CapacityAlternative[];
}

export interface CapacityResource {
  resourceType: string;
  currentCapacity: number;
  requiredCapacity: number;
  recommendedCapacity: number;
  scalingOptions: ScalingOption[];
}

export interface CapacityTimeline {
  period: string;
  demand: number;
  capacity: number;
  utilization: number;
  cost: CostAmount;
  actions: string[];
}

export interface CapacityCost {
  period: string;
  currentCost: CostAmount;
  projectedCost: CostAmount;
  optimizedCost: CostAmount;
  savings: CostAmount;
}

export interface CapacityRisk {
  type: 'underprovisioning' | 'overprovisioning' | 'performance_degradation';
  likelihood: 'low' | 'medium' | 'high';
  impact: 'low' | 'medium' | 'high';
  mitigation: string;
}

export interface CapacityAlternative {
  description: string;
  cost: CostAmount;
  benefits: string[];
  drawbacks: string[];
  feasibility: 'low' | 'medium' | 'high';
}

// Resource Configuration Types
export interface ResourceConfiguration {
  instanceType?: string;
  size?: string;
  cpu?: number;
  memory?: number;
  storage?: StorageConfiguration[];
  network?: NetworkConfiguration;
  tags: Record<string, string>;
  customProperties: Record<string, unknown>;
}

export interface StorageConfiguration {
  type: string;
  size: number;
  iops?: number;
  throughput?: number;
  encryption?: boolean;
}

export interface NetworkConfiguration {
  bandwidth: number;
  type: string;
  redundancy: boolean;
  encryption?: boolean;
}

// Scaling and Optimization Types
export interface ScalingOption {
  type: 'vertical' | 'horizontal';
  recommendation: string;
  estimatedCost: CostAmount;
  performanceGain: string;
  complexity: 'low' | 'medium' | 'high';
}

export interface RightsizingOption {
  targetSize: string;
  estimatedSavings: CostAmount;
  performanceImpact: string;
  risk: 'low' | 'medium' | 'high';
  effort: 'low' | 'medium' | 'high';
}

export interface OptimizationOpportunity {
  resourceId: string;
  type: 'rightsize' | 'shutdown' | 'schedule' | 'migrate' | 'upgrade';
  description: string;
  potentialSavings: CostAmount;
  effort: 'low' | 'medium' | 'high';
  risk: 'low' | 'medium' | 'high';
  confidence: number;
  timeline: string;
  prerequisites: string[];
}

// Efficiency Analysis Types
export interface EfficiencyAnalysis {
  overall: EfficiencyScore;
  byDimension: EfficiencyByDimension[];
  trends: EfficiencyTrend[];
  opportunities: EfficiencyOpportunity[];
  benchmarks: EfficiencyBenchmark[];
}

export interface EfficiencyScore {
  value: number;
  category: 'poor' | 'fair' | 'good' | 'excellent';
  components: EfficiencyComponent[];
}

export interface EfficiencyComponent {
  name: string;
  weight: number;
  score: number;
  impact: 'low' | 'medium' | 'high';
}

export interface EfficiencyByDimension {
  dimension: string;
  score: number;
  trend: TrendDirection;
  comparison: 'above_average' | 'average' | 'below_average';
}

export interface EfficiencyTrend {
  metric: string;
  direction: TrendDirection;
  rate: number;
  duration: string;
  significance: 'low' | 'medium' | 'high';
}

export interface EfficiencyOpportunity {
  area: string;
  description: string;
  potentialImprovement: number;
  effort: 'low' | 'medium' | 'high';
  impact: 'low' | 'medium' | 'high';
  recommendations: string[];
}

export interface EfficiencyBenchmark {
  category: string;
  industry: string;
  current: number;
  benchmark: number;
  percentile: number;
  gap: number;
}

// Workload Analysis Types
export interface WorkloadProfile {
  id: string;
  name: string;
  type: 'batch' | 'interactive' | 'real_time' | 'streaming' | 'mixed';
  characteristics: WorkloadCharacteristic[];
  patterns: WorkloadPattern[];
  requirements: WorkloadRequirement[];
}

export interface WorkloadCharacteristic {
  name: string;
  value: number;
  unit: string;
  variability: 'low' | 'medium' | 'high';
  predictability: 'low' | 'medium' | 'high';
}

export interface WorkloadPattern {
  type: 'steady' | 'periodic' | 'bursty' | 'seasonal' | 'irregular';
  description: string;
  frequency?: string;
  duration?: string;
  amplitude?: number;
}

export interface WorkloadRequirement {
  type: 'performance' | 'availability' | 'latency' | 'throughput' | 'reliability';
  value: number;
  unit: string;
  priority: 'low' | 'medium' | 'high' | 'critical';
  tolerance: number;
}

// Resource State Types
export interface ResourceState {
  resources: ResourceStateDetail[];
  totalCost: CostAmount;
  totalCapacity: Record<string, number>;
  utilization: Record<string, number>;
  performance: Record<string, number>;
}

export interface ResourceStateDetail {
  resourceId: string;
  configuration: ResourceConfiguration;
  cost: CostAmount;
  utilization: Record<string, number>;
  performance: Record<string, number>;
}

// Change Impact Types
export interface ResourceChange {
  resourceId: string;
  type: 'resize' | 'terminate' | 'migrate' | 'reconfigure';
  from: ResourceConfiguration;
  to: ResourceConfiguration;
  impact: ChangeImpact;
  complexity: 'low' | 'medium' | 'high';
  risk: 'low' | 'medium' | 'high';
}

export interface ChangeImpact {
  cost: CostAmount;
  performance: Record<string, number>;
  availability: string;
  dependencies: string[];
}