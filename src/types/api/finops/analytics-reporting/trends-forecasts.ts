/**
 * FinOps Trends and Forecasts Types
 *
 * Advanced trend analysis, forecasting models, business correlations,
 * and predictive analytics types.
 *
 * Generated by CC (Claude Code) - Modularized from analytics-reporting.ts
 */

import type { CostAmount } from '../shared';
import type { TrendProjection, TrendDriver, ForecastPrediction, ForecastConfidence, ForecastAccuracy, ForecastAssumption, ScenarioImpact } from './analytics-core'
import type { AnalyticsTrend, AnalyticsForecast, SeasonalityPattern, ForecastScenario } from './analytics-core'

// Enhanced Trend Analysis
export interface FinOpsTrend extends AnalyticsTrend {
  flowId: string;
  category: 'cost' | 'budget' | 'optimization' | 'governance' | 'utilization';
  alertThresholds: TrendAlertThreshold[];
  businessContext: TrendBusinessContext;
}

export interface TrendAlertThreshold {
  type: 'rate_of_change' | 'absolute_value' | 'duration' | 'volatility';
  threshold: number;
  severity: 'info' | 'warning' | 'critical';
  action: string;
}

export interface TrendBusinessContext {
  events: BusinessEvent[];
  correlations: BusinessCorrelation[];
  explanations: string[];
}

export interface BusinessEvent {
  date: string;
  type: 'launch' | 'migration' | 'optimization' | 'incident' | 'seasonal';
  description: string;
  impact: 'positive' | 'negative' | 'neutral';
}

export interface BusinessCorrelation {
  metric: string;
  correlation: number;
  significance: number;
  explanation: string;
}

// Enhanced Forecasting
export interface FinOpsForecast extends AnalyticsForecast {
  flowId: string;
  category: 'cost' | 'budget' | 'savings' | 'utilization';
  businessDrivers: ForecastBusinessDriver[];
  riskFactors: ForecastRiskFactor[];
  monitoring: ForecastMonitoring;
}

export interface ForecastBusinessDriver {
  name: string;
  type: 'growth' | 'efficiency' | 'market' | 'regulatory';
  impact: number;
  probability: number;
  timeline: string;
}

export interface ForecastRiskFactor {
  name: string;
  type: 'market' | 'technical' | 'operational' | 'regulatory';
  likelihood: 'low' | 'medium' | 'high';
  impact: 'low' | 'medium' | 'high';
  mitigation: string;
}

export interface ForecastMonitoring {
  triggers: ForecastTrigger[];
  alerts: ForecastAlert[];
  recalibration: ForecastRecalibration;
}

export interface ForecastTrigger {
  condition: string;
  threshold: number;
  action: 'recalculate' | 'alert' | 'escalate';
}

export interface ForecastAlert {
  condition: string;
  severity: 'info' | 'warning' | 'critical';
  recipients: string[];
  message: string;
}

export interface ForecastRecalibration {
  frequency: string;
  triggers: string[];
  automated: boolean;
  approval_required: boolean;
}

// Trend Analysis Models
export interface TrendAnalysisModel {
  id: string;
  name: string;
  type: 'linear' | 'exponential' | 'polynomial' | 'seasonal' | 'ml_ensemble';
  parameters: ModelParameters;
  performance: ModelPerformance;
  validation: ModelValidation;
  lastTrained: string;
  nextUpdate: string;
}

export interface ModelParameters {
  algorithm: string;
  hyperparameters: Record<string, string | number | boolean | null>;
  features: string[];
  targetMetric: string;
  trainingPeriod: string;
}

export interface ModelPerformance {
  accuracy: number;
  precision: number;
  recall: number;
  f1Score: number;
  meanAbsoluteError: number;
  rootMeanSquareError: number;
  confidenceInterval: number;
}

export interface ModelValidation {
  method: 'cross_validation' | 'holdout' | 'time_series_split';
  testSize: number;
  validationScore: number;
  overfitting: 'low' | 'medium' | 'high';
  stability: 'stable' | 'unstable' | 'volatile';
}

// Seasonality and Pattern Analysis
export interface SeasonalityAnalysis {
  patterns: SeasonalityPattern[];
  strength: number;
  reliability: number;
  businessRelevance: string[];
  adjustmentFactors: SeasonalAdjustment[];
  holidays: HolidayImpact[];
}

export interface SeasonalAdjustment {
  period: string;
  factor: number;
  confidence: number;
  reason: string;
}

export interface HolidayImpact {
  holiday: string;
  date: string;
  type: 'increase' | 'decrease' | 'shift';
  magnitude: number;
  duration: number;
  affectedMetrics: string[];
}

// Advanced Forecasting Scenarios
export interface ScenarioPlanning {
  baseScenario: ForecastScenario;
  alternativeScenarios: ForecastScenario[];
  monteCarlo: MonteCarloSimulation;
  sensitivityAnalysis: SensitivityAnalysis;
  stressTest: StressTestScenario[];
}

export interface MonteCarloSimulation {
  iterations: number;
  variables: SimulationVariable[];
  results: SimulationResults;
  convergence: ConvergenceMetrics;
}

export interface SimulationVariable {
  name: string;
  distribution: 'normal' | 'uniform' | 'triangular' | 'beta';
  parameters: Record<string, number>;
  correlation: VariableCorrelation[];
}

export interface VariableCorrelation {
  variable: string;
  coefficient: number;
  strength: 'weak' | 'moderate' | 'strong';
}

export interface SimulationResults {
  mean: number;
  median: number;
  standardDeviation: number;
  percentiles: Record<string, number>;
  confidenceIntervals: ConfidenceInterval[];
  riskMetrics: RiskMetrics;
}

export interface ConfidenceInterval {
  level: number;
  lowerBound: number;
  upperBound: number;
}

export interface RiskMetrics {
  valueAtRisk: number;
  conditionalValueAtRisk: number;
  maxDrawdown: number;
  probabilityOfLoss: number;
}

export interface ConvergenceMetrics {
  achieved: boolean;
  iterations: number;
  standardError: number;
  convergenceRate: number;
}

export interface SensitivityAnalysis {
  variables: SensitivityVariable[];
  interactions: VariableInteraction[];
  ranking: VariableRanking[];
  tornado: TornadoDiagram;
}

export interface SensitivityVariable {
  name: string;
  baseValue: number;
  testRange: {
    min: number;
    max: number;
  };
  impact: SensitivityImpact[];
}

export interface SensitivityImpact {
  changePercent: number;
  outputChange: number;
  elasticity: number;
}

export interface VariableInteraction {
  variables: string[];
  interactionEffect: number;
  significance: 'low' | 'medium' | 'high';
  type: 'synergistic' | 'antagonistic' | 'neutral';
}

export interface VariableRanking {
  variable: string;
  importance: number;
  rank: number;
  contribution: number;
}

export interface TornadoDiagram {
  variables: TornadoVariable[];
  baseCase: number;
  sensitivityRange: {
    min: number;
    max: number;
  };
}

export interface TornadoVariable {
  name: string;
  lowImpact: number;
  highImpact: number;
  range: number;
  rank: number;
}

export interface StressTestScenario {
  name: string;
  description: string;
  type: 'historical' | 'hypothetical' | 'regulatory';
  severity: 'mild' | 'moderate' | 'severe' | 'extreme';
  duration: string;
  shocks: StressTestShock[];
  results: StressTestResults;
}

export interface StressTestShock {
  variable: string;
  magnitude: number;
  direction: 'increase' | 'decrease';
  timing: 'immediate' | 'gradual' | 'delayed';
  persistence: 'temporary' | 'permanent' | 'cyclical';
}

export interface StressTestResults {
  worstCase: CostAmount;
  recovery: RecoveryMetrics;
  breakingPoints: BreakingPoint[];
  resilience: ResilienceMetrics;
}

export interface RecoveryMetrics {
  timeToRecover: string;
  recoveryRate: number;
  partialRecovery: boolean;
  residualImpact: number;
}

export interface BreakingPoint {
  metric: string;
  threshold: number;
  consequences: string[];
  mitigation: string[];
}

export interface ResilienceMetrics {
  adaptability: number;
  robustness: number;
  redundancy: number;
  rapidityOfRecovery: number;
  overallScore: number;
}
