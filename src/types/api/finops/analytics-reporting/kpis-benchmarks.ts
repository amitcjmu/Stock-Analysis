/**
 * FinOps KPIs and Benchmarks Types
 * 
 * Key Performance Indicators, benchmarking, comparative analysis,
 * and performance measurement types.
 * 
 * Generated by CC (Claude Code) - Modularized from analytics-reporting.ts
 */

import { CostAmount } from '../shared';

// KPI Management
export interface FinOpsKPI {
  id: string;
  name: string;
  category: 'cost' | 'budget' | 'optimization' | 'governance' | 'efficiency';
  type: 'absolute' | 'ratio' | 'percentage' | 'index';
  value: number;
  unit: string;
  target: KPITarget;
  status: KPIStatus;
  trend: KPITrend;
  benchmark: KPIBenchmark;
  calculation: KPICalculation;
  reporting: KPIReporting;
}

export interface KPITarget {
  value: number;
  type: 'minimum' | 'maximum' | 'range' | 'exact';
  range?: {
    min: number;
    max: number;
  };
  timeframe: string;
  rationale: string;
}

export interface KPIStatus {
  meeting: number;
  atRisk: number;
  missing: number;
  total: number;
  overallHealth: 'healthy' | 'warning' | 'critical';
}

export interface KPITrend {
  direction: 'improving' | 'declining' | 'stable';
  velocity: number;
  consistency: number;
  seasonality: boolean;
  projection: KPIProjection;
}

export interface KPIProjection {
  nextPeriod: number;
  confidence: number;
  targetAchievement: 'likely' | 'possible' | 'unlikely';
  recommendedActions: string[];
}

export interface KPIBenchmark {
  internal: number;
  industry: number;
  bestPractice: number;
  percentile: number;
  relative_performance: 'leading' | 'average' | 'lagging';
}

export interface KPICalculation {
  formula: string;
  inputs: KPIInput[];
  frequency: string;
  methodology: string;
  limitations: string[];
}

export interface KPIInput {
  name: string;
  source: string;
  freshness: string;
  reliability: number;
}

export interface KPIReporting {
  frequency: 'real_time' | 'daily' | 'weekly' | 'monthly' | 'quarterly';
  recipients: string[];
  format: 'dashboard' | 'report' | 'alert' | 'email';
  escalation: KPIEscalation[];
}

export interface KPIEscalation {
  condition: string;
  threshold: number;
  recipients: string[];
  urgency: 'low' | 'medium' | 'high' | 'critical';
}

// Benchmarking
export interface FinOpsBenchmark {
  id: string;
  name: string;
  type: 'industry' | 'peer' | 'internal' | 'best_practice';
  category: 'cost_efficiency' | 'optimization_maturity' | 'governance_compliance';
  metric: string;
  value: number;
  unit: string;
  percentile: number;
  comparison: BenchmarkComparison;
  context: BenchmarkContext;
  actionability: BenchmarkActionability;
}

export interface BenchmarkComparison {
  current: number;
  benchmark: number;
  variance: number;
  performance: 'leading' | 'average' | 'lagging';
  ranking: number;
  totalParticipants: number;
}

export interface BenchmarkContext {
  industry: string;
  companySize: string;
  geography: string;
  methodology: string;
  dataSource: string;
  lastUpdated: string;
}

export interface BenchmarkActionability {
  improvementPotential: number;
  difficultyLevel: 'low' | 'medium' | 'high';
  timeToImprovement: string;
  requiredInvestment: CostAmount;
  recommendations: string[];
}

// KPI Hierarchies and Categories
export interface KPIHierarchy {
  level: 'executive' | 'operational' | 'tactical';
  categories: KPICategory[];
  relationships: KPIRelationship[];
  rollupRules: KPIRollupRule[];
}

export interface KPICategory {
  id: string;
  name: string;
  description: string;
  weight: number;
  kpis: string[];
  subcategories: KPICategory[];
}

export interface KPIRelationship {
  parentKPI: string;
  childKPI: string;
  type: 'rollup' | 'driver' | 'correlation' | 'dependency';
  strength: number;
  formula?: string;
}

export interface KPIRollupRule {
  parentKPI: string;
  childKPIs: string[];
  aggregation: 'sum' | 'average' | 'weighted_average' | 'custom';
  weights: Record<string, number>;
  customLogic?: string;
}

// KPI Performance Analysis
export interface KPIPerformanceAnalysis {
  kpi: string;
  timeframe: string;
  historical: KPIHistoricalData[];
  variance: KPIVarianceAnalysis;
  rootCause: RootCauseAnalysis;
  improvement: ImprovementOpportunity[];
}

export interface KPIHistoricalData {
  period: string;
  value: number;
  target: number;
  variance: number;
  events: string[];
}

export interface KPIVarianceAnalysis {
  total: number;
  components: VarianceComponent[];
  significantDrivers: string[];
  seasonalEffect: number;
}

export interface VarianceComponent {
  factor: string;
  contribution: number;
  type: 'favorable' | 'unfavorable';
  controllable: boolean;
}

export interface RootCauseAnalysis {
  primaryCauses: CauseAnalysis[];
  contributingFactors: ContributingFactor[];
  methodology: 'five_whys' | 'fishbone' | 'statistical' | 'ml_analysis';
  confidence: number;
}

export interface CauseAnalysis {
  cause: string;
  category: 'process' | 'people' | 'technology' | 'external';
  impact: number;
  evidence: string[];
  corrective_actions: string[];
}

export interface ContributingFactor {
  factor: string;
  weight: number;
  interaction: string[];
  mitigation: string;
}

export interface ImprovementOpportunity {
  area: string;
  potential: number;
  effort: 'low' | 'medium' | 'high';
  timeline: string;
  investment: CostAmount;
  roi: number;
  risk: 'low' | 'medium' | 'high';
  prerequisites: string[];
}

// Benchmark Analysis
export interface BenchmarkAnalysis {
  benchmark: string;
  participants: BenchmarkParticipant[];
  methodology: BenchmarkMethodology;
  results: BenchmarkResults;
  insights: BenchmarkInsight[];
  actionPlan: BenchmarkActionPlan;
}

export interface BenchmarkParticipant {
  id: string;
  profile: ParticipantProfile;
  metrics: Record<string, number>;
  anonymized: boolean;
}

export interface ParticipantProfile {
  industry: string;
  size: string;
  geography: string;
  maturity: 'beginner' | 'intermediate' | 'advanced' | 'expert';
  characteristics: Record<string, string | number | boolean | null>;
}

export interface BenchmarkMethodology {
  dataCollection: string;
  normalization: string[];
  outlierTreatment: string;
  confidentiality: string;
  validation: string[];
  limitations: string[];
}

export interface BenchmarkResults {
  distribution: BenchmarkDistribution;
  correlations: BenchmarkCorrelation[];
  segments: BenchmarkSegment[];
  trends: BenchmarkTrend[];
}

export interface BenchmarkDistribution {
  metric: string;
  percentiles: Record<string, number>;
  quartiles: {
    q1: number;
    q2: number;
    q3: number;
  };
  outliers: number[];
  normalityTest: NormalityTest;
}

export interface NormalityTest {
  test: 'shapiro_wilk' | 'kolmogorov_smirnov' | 'anderson_darling';
  pValue: number;
  isNormal: boolean;
  transformation?: string;
}

export interface BenchmarkCorrelation {
  metric1: string;
  metric2: string;
  correlation: number;
  significance: number;
  causality?: 'none' | 'metric1_causes_metric2' | 'metric2_causes_metric1' | 'bidirectional';
}

export interface BenchmarkSegment {
  name: string;
  criteria: SegmentCriteria[];
  size: number;
  characteristics: Record<string, number>;
  performance: SegmentPerformance;
}

export interface SegmentCriteria {
  dimension: string;
  operator: 'equals' | 'greater_than' | 'less_than' | 'in_range' | 'contains';
  value: unknown;
}

export interface SegmentPerformance {
  metrics: Record<string, number>;
  ranking: number;
  distinctiveFactors: string[];
  bestPractices: string[];
}

export interface BenchmarkTrend {
  metric: string;
  timeframe: string;
  direction: 'improving' | 'declining' | 'stable';
  magnitude: number;
  drivers: string[];
  forecast: TrendForecast;
}

export interface TrendForecast {
  nextPeriod: number;
  confidence: number;
  scenario: 'conservative' | 'realistic' | 'optimistic';
}

export interface BenchmarkInsight {
  type: 'gap_analysis' | 'best_practice' | 'opportunity' | 'risk';
  description: string;
  impact: 'low' | 'medium' | 'high';
  evidence: string[];
  recommendations: string[];
}

export interface BenchmarkActionPlan {
  objectives: ActionObjective[];
  initiatives: ActionInitiative[];
  timeline: ActionTimeline;
  resources: ActionResource[];
  monitoring: ActionMonitoring;
}

export interface ActionObjective {
  goal: string;
  target: number;
  deadline: string;
  metrics: string[];
  success_criteria: string[];
}

export interface ActionInitiative {
  name: string;
  description: string;
  priority: 'low' | 'medium' | 'high';
  effort: 'low' | 'medium' | 'high';
  impact: 'low' | 'medium' | 'high';
  dependencies: string[];
  milestones: InitiativeMilestone[];
}

export interface InitiativeMilestone {
  name: string;
  date: string;
  deliverables: string[];
  success_criteria: string[];
}

export interface ActionTimeline {
  phases: TimelinePhase[];
  criticalPath: string[];
  bufferTime: number;
  riskMitigation: string[];
}

export interface TimelinePhase {
  name: string;
  startDate: string;
  endDate: string;
  initiatives: string[];
  dependencies: string[];
}

export interface ActionResource {
  type: 'human' | 'financial' | 'technical' | 'external';
  name: string;
  allocation: number;
  cost: CostAmount;
  availability: string[];
}

export interface ActionMonitoring {
  frequency: string;
  metrics: string[];
  reports: MonitoringReport[];
  alerts: MonitoringAlert[];
  reviews: ProgressReview[];
}

export interface MonitoringReport {
  type: string;
  frequency: string;
  recipients: string[];
  format: string;
  automation: boolean;
}

export interface MonitoringAlert {
  condition: string;
  threshold: number;
  severity: 'info' | 'warning' | 'critical';
  recipients: string[];
  escalation: string[];
}

export interface ProgressReview {
  type: 'checkpoint' | 'milestone' | 'phase_gate';
  date: string;
  participants: string[];
  agenda: string[];
  decisions: ReviewDecision[];
}

export interface ReviewDecision {
  decision: string;
  rationale: string;
  impact: string[];
  followup: string[];
}