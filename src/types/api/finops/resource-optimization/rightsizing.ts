/**
 * FinOps Resource Rightsizing Types
 *
 * Type definitions focused on resource rightsizing strategies,
 * analysis, recommendations, and implementation.
 *
 * Generated by CC (Claude Code) - Modularized from resource-optimization.ts
 */

import type {
  BaseApiRequest,
  BaseApiResponse,
  MultiTenantContext
} from '../../shared';
import type { CostAmount } from '../cost-analysis';
import type {
  PerformanceRequirement,
  CostThreshold,
  UtilizationPattern
} from '../shared';

// Rightsizing APIs
export interface RightsizeResourcesRequest extends BaseApiRequest {
  flowId: string;
  resourceIds: string[];
  rightsizingStrategy: RightsizingStrategy;
  performanceRequirements: PerformanceRequirement[];
  costThresholds: CostThreshold[];
  dryRun?: boolean;
  context: MultiTenantContext;
}

export interface RightsizeResourcesResponse extends BaseApiResponse<RightsizingResult> {
  data: RightsizingResult;
  rightsizingId: string;
  recommendations: RightsizingRecommendation[];
  projectedSavings: CostAmount;
  performanceImpact: RightsizingPerformanceImpact;
  implementationPlan: RightsizingImplementationPlan;
}

// Rightsizing Strategy Types
export interface RightsizingStrategy {
  approach: 'conservative' | 'moderate' | 'aggressive';
  criteria: RightsizingCriteria;
  constraints: RightsizingConstraint[];
  optimization: RightsizingOptimization;
}

export interface RightsizingCriteria {
  utilizationThreshold: number;
  observationPeriod: string;
  performanceBuffer: number;
  costThreshold: number;
  excludeRecent: boolean;
}

export interface RightsizingConstraint {
  type: 'minimum_size' | 'family_restriction' | 'feature_requirement';
  value: unknown;
  description: string;
}

export interface RightsizingOptimization {
  objective: 'cost' | 'performance' | 'balanced';
  aggressiveness: number;
  includeFamily: boolean;
  includeGeneration: boolean;
}

// Rightsizing Analysis Types
export interface RightsizingResult {
  id: string;
  strategy: RightsizingStrategy;
  analysis: RightsizingAnalysis;
  recommendations: RightsizingRecommendation[];
  summary: RightsizingSummary;
  validation: RightsizingValidation;
}

export interface RightsizingAnalysis {
  resourcesAnalyzed: number;
  candidatesIdentified: number;
  utilizationPatterns: UtilizationPattern[];
  performanceBaseline: Record<string, number>;
  costBaseline: CostAmount;
}

export interface RightsizingRecommendation {
  resourceId: string;
  currentSize: string;
  recommendedSize: string;
  confidence: number;
  savings: CostAmount;
  performanceImpact: RightsizingPerformanceImpact;
  implementation: RightsizingImplementation;
  risk: 'low' | 'medium' | 'high';
}

export interface RightsizingPerformanceImpact {
  metrics: Record<string, number>;
  slaRisk: boolean;
  degradationRisk: 'none' | 'minimal' | 'moderate' | 'significant';
  mitigations: string[];
}

export interface RightsizingImplementation {
  method: 'resize' | 'replace' | 'migrate';
  downtime: string;
  complexity: 'low' | 'medium' | 'high';
  prerequisites: string[];
  steps: string[];
  validation: string[];
}

export interface RightsizingSummary {
  totalSavings: CostAmount;
  savingsPercentage: number;
  resourcesOptimized: number;
  averageReduction: number;
  riskDistribution: Record<string, number>;
}

// Rightsizing Validation Types
export interface RightsizingValidation {
  preChecks: ValidationResult[];
  postChecks: ValidationResult[];
  performanceValidation: PerformanceValidationResult;
  costValidation: CostValidationResult;
}

export interface ValidationResult {
  check: string;
  status: 'passed' | 'failed' | 'warning';
  details: string;
  timestamp: string;
}

export interface PerformanceValidationResult {
  baselineComparison: Record<string, number>;
  slaCompliance: boolean;
  degradationDetected: boolean;
  issues: string[];
}

export interface CostValidationResult {
  expectedSavings: CostAmount;
  actualSavings: CostAmount;
  variance: number;
  realizationRate: number;
}

// Rightsizing Implementation Types
export interface RightsizingImplementationPlan {
  phases: RightsizingPhase[];
  timeline: string;
  rollback: RightsizingRollback;
  monitoring: RightsizingMonitoring;
}

export interface RightsizingPhase {
  id: string;
  name: string;
  resources: string[];
  order: 'sequential' | 'parallel';
  duration: string;
  validation: string[];
}

export interface RightsizingRollback {
  enabled: boolean;
  triggers: string[];
  procedures: string[];
  timeLimit: string;
}

export interface RightsizingMonitoring {
  metrics: string[];
  duration: string;
  alerts: string[];
  reporting: string;
}
