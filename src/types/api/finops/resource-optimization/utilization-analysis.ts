/**
 * FinOps Resource Utilization Analysis Types
 * 
 * Type definitions focused on resource utilization analysis,
 * monitoring, and optimization recommendations.
 * 
 * Generated by CC (Claude Code) - Modularized from resource-optimization.ts
 */

import {
  BaseApiRequest,
  BaseApiResponse,
  MultiTenantContext
} from '../../shared';
import { CostAmount } from '../cost-analysis';
import {
  FinOpsResource,
  ResourceType,
  TimeRange,
  UtilizationMetric,
  UtilizationThreshold,
  ResourceUtilization,
  UtilizationSummary,
  UtilizationTrend,
  UtilizationAnomaly,
  ResourceEfficiency
} from '../shared';

// Resource Utilization Analysis APIs
export interface AnalyzeResourceUtilizationRequest extends BaseApiRequest {
  flowId: string;
  resourceTypes: ResourceType[];
  timeRange: TimeRange;
  metrics: UtilizationMetric[];
  thresholds: UtilizationThreshold[];
  includeRecommendations?: boolean;
  context: MultiTenantContext;
}

export interface AnalyzeResourceUtilizationResponse extends BaseApiResponse<ResourceUtilizationAnalysis> {
  data: ResourceUtilizationAnalysis;
  analysisId: string;
  utilizationSummary: UtilizationSummary;
  underutilizedResources: UnderutilizedResource[];
  overutilizedResources: OverutilizedResource[];
  recommendations: ResourceRecommendation[];
}

// Analysis Result Types
export interface ResourceUtilizationAnalysis {
  id: string;
  flowId: string;
  analysisType: 'current' | 'historical' | 'trending';
  timeRange: TimeRange;
  scope: ResourceAnalysisScope;
  summary: UtilizationSummary;
  resourceAnalysis: ResourceAnalysisDetail[];
  recommendations: ResourceRecommendation[];
  trends: UtilizationTrend[];
  anomalies: UtilizationAnomaly[];
  generatedAt: string;
}

export interface ResourceAnalysisScope {
  resourceTypes: ResourceType[];
  accounts: string[];
  regions: string[];
  projects: string[];
  environments: string[];
  tags: Record<string, string>;
}

export interface ResourceAnalysisDetail {
  resourceId: string;
  resourceType: ResourceType;
  name: string;
  cost: CostAmount;
  utilization: ResourceUtilization;
  performance: ResourcePerformance;
  recommendations: ResourceSpecificRecommendation[];
  tags: Record<string, string>;
}

export interface ResourcePerformance {
  latency: PerformanceMetric;
  throughput: PerformanceMetric;
  availability: PerformanceMetric;
  errorRate: PerformanceMetric;
  customMetrics: PerformanceMetric[];
  slaCompliance: SLACompliance;
}

export interface PerformanceMetric {
  name: string;
  current: number;
  baseline: number;
  target: number;
  unit: string;
  trend: 'improving' | 'degrading' | 'stable';
  status: 'meeting' | 'below' | 'above' | 'unknown';
}

export interface SLACompliance {
  overall: number;
  metrics: SLAMetricCompliance[];
  violations: SLAViolation[];
  riskLevel: 'low' | 'medium' | 'high';
}

export interface SLAMetricCompliance {
  metric: string;
  target: number;
  actual: number;
  compliance: number;
  status: 'compliant' | 'at_risk' | 'violated';
}

export interface SLAViolation {
  metric: string;
  timestamp: string;
  duration: string;
  severity: 'minor' | 'major' | 'critical';
  impact: string;
}

// Under/Over Utilized Resource Types
export interface UnderutilizedResource {
  resourceId: string;
  name: string;
  type: ResourceType;
  cost: CostAmount;
  utilizationScore: number;
  wastedCapacity: Record<string, number>;
  potentialSavings: CostAmount;
  rightsizingOptions: RightsizingOption[];
  shutdownCandidate: boolean;
}

export interface OverutilizedResource {
  resourceId: string;
  name: string;
  type: ResourceType;
  cost: CostAmount;
  utilizationScore: number;
  constrainedMetrics: string[];
  performanceImpact: string;
  scalingOptions: ScalingOption[];
  urgency: 'low' | 'medium' | 'high' | 'critical';
}

export interface RightsizingOption {
  targetSize: string;
  estimatedSavings: CostAmount;
  performanceImpact: string;
  risk: 'low' | 'medium' | 'high';
  effort: 'low' | 'medium' | 'high';
}

export interface ScalingOption {
  type: 'vertical' | 'horizontal';
  recommendation: string;
  estimatedCost: CostAmount;
  performanceGain: string;
  complexity: 'low' | 'medium' | 'high';
}

// Recommendation Types
export interface ResourceRecommendation {
  id: string;
  resourceId: string;
  type: 'rightsize' | 'shutdown' | 'upgrade' | 'migrate' | 'optimize';
  priority: 'low' | 'medium' | 'high' | 'critical';
  title: string;
  description: string;
  currentConfiguration: ResourceConfiguration;
  recommendedConfiguration: ResourceConfiguration;
  estimatedSavings: CostAmount;
  performanceImpact: string;
  implementationComplexity: 'low' | 'medium' | 'high';
  risk: 'low' | 'medium' | 'high';
  timeline: string;
  prerequisites: string[];
  validationSteps: string[];
}

export interface ResourceSpecificRecommendation extends ResourceRecommendation {
  confidence: number;
  basedOnPeriod: string;
  assumptions: string[];
  alternatives: AlternativeRecommendation[];
}

export interface AlternativeRecommendation {
  description: string;
  savings: CostAmount;
  risk: 'low' | 'medium' | 'high';
  effort: 'low' | 'medium' | 'high';
}

export interface ResourceConfiguration {
  instanceType?: string;
  size?: string;
  cpu?: number;
  memory?: number;
  storage?: StorageConfiguration[];
  network?: NetworkConfiguration;
  tags: Record<string, string>;
  customProperties: Record<string, any>;
}

export interface StorageConfiguration {
  type: string;
  size: number;
  iops?: number;
  throughput?: number;
  encryption?: boolean;
}

export interface NetworkConfiguration {
  bandwidth: number;
  type: string;
  redundancy: boolean;
  encryption?: boolean;
}