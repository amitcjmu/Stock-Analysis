/**
 * Compliance Validation Types
 * 
 * Compliance checking, validation, and violation management.
 * 
 * Generated by CC - Claude Code
 */

import {
  BaseApiRequest,
  BaseApiResponse,
  MultiTenantContext
} from '../../shared';

// Compliance Validation API
export interface ValidateCostGovernanceRequest extends BaseApiRequest {
  flowId: string;
  policyIds?: string[];
  validationType: 'realtime' | 'scheduled' | 'on_demand';
  scope: ValidationScope;
  includeRemediation?: boolean;
  context: MultiTenantContext;
}

export interface ValidateCostGovernanceResponse extends BaseApiResponse<GovernanceValidationResult> {
  data: GovernanceValidationResult;
  validationId: string;
  complianceScore: number;
  violations: PolicyViolation[];
  recommendations: ComplianceRecommendation[];
  remediationPlan: RemediationPlan;
}

// Validation Types
export interface ValidationScope {
  policies: string[];
  accounts: string[];
  services: string[];
  timeRange: {
    start: string;
    end: string;
  };
  depth: 'surface' | 'detailed' | 'comprehensive';
}

export interface GovernanceValidationResult {
  id: string;
  scope: ValidationScope;
  complianceScore: number;
  status: 'compliant' | 'non_compliant' | 'partially_compliant';
  summary: ValidationSummary;
  violations: PolicyViolation[];
  recommendations: ComplianceRecommendation[];
  remediationPlan: RemediationPlan;
  generatedAt: string;
}

export interface ValidationSummary {
  policiesChecked: number;
  rulesEvaluated: number;
  violationsFound: number;
  complianceRate: number;
  riskLevel: 'low' | 'medium' | 'high' | 'critical';
  categories: CategorySummary[];
}

export interface CategorySummary {
  category: string;
  compliance: number;
  violations: number;
  risk: 'low' | 'medium' | 'high' | 'critical';
}

export interface PolicyViolation {
  id: string;
  policyId: string;
  ruleId: string;
  severity: 'low' | 'medium' | 'high' | 'critical';
  type: string;
  description: string;
  resource: ViolationResource;
  detectedAt: string;
  impact: ViolationImpact;
  evidence: ViolationEvidence;
  context: ViolationContext;
  recommendations: string[];
}

export interface ViolationResource {
  id: string;
  type: string;
  name: string;
  account: string;
  region: string;
  tags: Record<string, string>;
}

export interface ViolationImpact {
  financial: number;
  operational: string;
  security: string;
  compliance: string;
}

export interface ViolationEvidence {
  metrics: Record<string, unknown>;
  logs: string[];
  screenshots?: string[];
  configurations: Record<string, unknown>;
}

export interface ViolationContext {
  user: string;
  project: string;
  environment: string;
  costCenter: string;
  businessJustification?: string;
}

export interface ComplianceRecommendation {
  id: string;
  type: 'immediate' | 'short_term' | 'long_term' | 'strategic';
  priority: 'low' | 'medium' | 'high' | 'critical';
  title: string;
  description: string;
  impact: RecommendationImpact;
  effort: 'low' | 'medium' | 'high';
  cost: number;
  timeline: string;
  dependencies: string[];
  alternatives: string[];
}

export interface RecommendationImpact {
  compliance: number;
  cost: number;
  risk: number;
  operational: string;
}

export interface ComplianceCheck {
  id: string;
  name: string;
  type: 'automated' | 'manual' | 'hybrid';
  frequency: string;
  scope: string[];
  criteria: CheckCriteria[];
  remediation: CheckRemediation;
}

export interface CheckCriteria {
  rule: string;
  threshold: unknown;
  operator: string;
  tolerance: number;
}

export interface CheckRemediation {
  automated: boolean;
  actions: string[];
  approval_required: boolean;
  escalation: string[];
}