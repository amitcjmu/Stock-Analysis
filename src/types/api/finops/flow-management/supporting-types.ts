/**
 * FinOps Supporting Types
 *
 * Type definitions for actions, KPIs, recommendations, decisions, status details,
 * and other supporting data structures used across FinOps flows.
 *
 * Generated by CC - Modularized from flow-management.ts
 */

import type { ConfigurationValue } from '../../../shared/config-types';
import type { FinOpsStatus } from './flow-core-types';

export interface FinOpsAction {
  id: string;
  type: 'cost_optimization' | 'budget_adjustment' | 'resource_scaling' | 'policy_enforcement';
  name: string;
  description: string;
  impact: ActionImpact;
  effort: 'low' | 'medium' | 'high';
  priority: number;
  status: 'pending' | 'in_progress' | 'completed' | 'failed';
  assignee?: string;
  dueDate?: string;
}

export interface ActionImpact {
  costSavings?: number;
  performanceImpact?: string;
  riskReduction?: string;
  complianceImprovement?: string;
}

export interface FinOpsKPI {
  name: string;
  value: number;
  target: number;
  unit: string;
  trend: 'improving' | 'declining' | 'stable';
  status: 'on_track' | 'at_risk' | 'off_track';
}

export interface FinOpsRecommendation {
  id: string;
  type: string;
  title: string;
  description: string;
  impact: RecommendationImpact;
  effort: 'low' | 'medium' | 'high';
  priority: number;
  actions: string[];
}

export interface RecommendationImpact {
  cost: number;
  performance: string;
  risk: string;
  compliance: string;
}

export interface FinOpsDecision {
  id: string;
  type: string;
  description: string;
  options: DecisionOption[];
  selectedOption?: string;
  rationale?: string;
  decidedBy?: string;
  decidedAt?: string;
}

export interface DecisionOption {
  id: string;
  name: string;
  pros: string[];
  cons: string[];
  impact: Record<string, ConfigurationValue>;
}

export interface FinOpsAlert {
  id: string;
  type: string;
  severity: string;
  message: string;
  triggeredAt: string;
}

// Flow Status Detail Types
export interface FinOpsStatusDetail {
  flowId: string;
  status: FinOpsStatus;
  phase: PhaseDetail;
  progress: ProgressMetrics;
  health: HealthIndicators;
  timeline: TimelineStatus;
  blockers: Blocker[];
  nextSteps: NextStep[];
}

export interface PhaseDetail {
  current: string;
  completed: string[];
  remaining: string[];
  phaseProgress: number;
}

export interface ProgressMetrics {
  overall: number;
  byObjective: Record<string, number>;
  byPhase: Record<string, number>;
  milestones: MilestoneProgress[];
}

export interface MilestoneProgress {
  milestone: string;
  status: 'pending' | 'in_progress' | 'completed' | 'delayed';
  completedDate?: string;
  targetDate: string;
}

export interface HealthIndicators {
  overall: 'healthy' | 'at_risk' | 'critical';
  cost: HealthStatus;
  optimization: HealthStatus;
  compliance: HealthStatus;
  governance: HealthStatus;
}

export interface HealthStatus {
  status: 'healthy' | 'warning' | 'critical';
  score: number;
  issues: string[];
}

export interface TimelineStatus {
  startDate: string;
  endDate: string;
  currentDate: string;
  daysElapsed: number;
  daysRemaining: number;
  onTrack: boolean;
}

export interface Blocker {
  id: string;
  type: string;
  description: string;
  impact: string;
  resolution: string;
  owner?: string;
}

export interface NextStep {
  action: string;
  description: string;
  dueDate?: string;
  owner?: string;
}

// Flow Summary Types
export interface FinOpsFlowSummary {
  id: string;
  name: string;
  status: string;
  progress: number;
  cost: CostSummary;
}

export interface CostSummary {
  current: number;
  budget: number;
  forecast: number;
  savings: number;
  currency: string;
}

// Aggregation and Metrics Types
export interface FinOpsAggregation {
  name: string;
  type: string;
  field: string;
  value: AggregationValue;
}

export interface AggregationValue {
  sum?: number;
  average?: number;
  count?: number;
  min?: number;
  max?: number;
  distribution?: Record<string, number>;
}

export interface FinOpsTrend {
  metric: string;
  direction: string;
  value: number;
}

export interface FinOpsBenchmark {
  metric: string;
  value: number;
  percentile: number;
}

export interface FinOpsPortfolioMetrics {
  totalCost: number;
  totalBudget: number;
  totalSavings: number;
  flowCount: number;
  activeOptimizations: number;
  complianceScore: number;
  efficiencyRatio: number;
  trends: PortfolioTrend[];
}

export interface PortfolioTrend {
  metric: string;
  current: number;
  previous: number;
  change: number;
  trend: 'improving' | 'declining' | 'stable';
}
