/**
 * Cost Pools Management Types
 *
 * Types for cost pool definition, drivers, budget tracking, and governance.
 * Covers shared services, infrastructure pools, and cost driver management.
 *
 * Generated by CC (Claude Code) - Modularized from cost-allocation.ts
 */

import type { CostAmount } from '../cost-analysis';

// Cost Pool Types
export interface CostPool {
  id: string;
  name: string;
  description: string;
  type: 'shared_services' | 'infrastructure' | 'overhead' | 'direct' | 'indirect';
  scope: CostPoolScope;
  allocation: CostPoolAllocation;
  drivers: CostDriver[];
  budget: CostPoolBudget;
  tracking: CostPoolTracking;
  governance: CostPoolGovernance;
}

export interface CostPoolScope {
  services: string[];
  resources: string[];
  accounts: string[];
  costCategories: string[];
  tags: Record<string, string>;
  timeframe: string;
}

export interface CostPoolAllocation {
  method: 'usage_based' | 'benefit_based' | 'capacity_based' | 'equal' | 'negotiated';
  drivers: string[];
  frequency: 'real_time' | 'daily' | 'weekly' | 'monthly';
  automation: boolean;
}

// Cost Driver Types
export interface CostDriver {
  id: string;
  name: string;
  type: 'usage' | 'capacity' | 'transaction' | 'headcount' | 'revenue' | 'custom';
  metric: string;
  source: string;
  weight: number;
  normalization: DriverNormalization;
  validation: DriverValidation;
}

export interface DriverNormalization {
  method: 'none' | 'min_max' | 'z_score' | 'percentage';
  baseline: number;
  factors: Record<string, number>;
}

export interface DriverValidation {
  range: {
    min: number;
    max: number;
  };
  outlier_detection: boolean;
  correlation_check: boolean;
  consistency_check: boolean;
}

// Budget and Tracking Types
export interface CostPoolBudget {
  totalBudget: CostAmount;
  allocation: BudgetAllocation[];
  tracking: boolean;
  variance: VarianceTracking;
}

export interface BudgetAllocation {
  target: string;
  amount: CostAmount;
  percentage: number;
  basis: string;
}

export interface VarianceTracking {
  threshold: number;
  frequency: string;
  escalation: string[];
  investigation: boolean;
}

export interface CostPoolTracking {
  metrics: string[];
  reporting: string[];
  alerts: PoolAlert[];
  dashboard: string;
}

export interface PoolAlert {
  metric: string;
  threshold: number;
  condition: string;
  severity: 'info' | 'warning' | 'critical';
  action: string;
}

// Pool Governance Types
export interface CostPoolGovernance {
  owner: string;
  stakeholders: string[];
  reviewFrequency: string;
  approvals: PoolApprovalConfig;
  audit: PoolAuditConfig;
}

export interface PoolApprovalConfig {
  required: string[];
  threshold: number;
  workflow: string;
  timeout: string;
}

export interface PoolAuditConfig {
  frequency: string;
  scope: string[];
  automated: boolean;
  documentation: string[];
}
