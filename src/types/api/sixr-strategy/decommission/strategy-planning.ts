/**
 * Decommission Strategy and Planning Types
 *
 * Types for decommission strategy definition, timeline planning, phases,
 * and milestone management.
 *
 * Generated by CC (Claude Code) - Modularized from decommission/index.ts
 */

import type { CreateRequest, CreateResponse } from '../../shared';
import type { CommunicationPlan, RollbackPlan } from '../shared';
import type { DecommissionScope } from './system-inventory';

// Strategy Planning Request/Response Types
export interface CreateDecommissionPlanRequest extends CreateRequest<DecommissionPlanData> {
  flowId: string;
  data: DecommissionPlanData;
  planningMethod: 'big_bang' | 'phased' | 'parallel_run' | 'gradual_cutover';
  riskMitigation: RiskMitigationStrategy[];
  dataHandling: DataHandlingStrategy;
  communicationPlan: CommunicationPlan;
  rollbackPlan: RollbackPlan;
  complianceRequirements: ComplianceRequirement[];
}

export interface CreateDecommissionPlanResponse extends CreateResponse<DecommissionPlan> {
  data: DecommissionPlan;
  planId: string;
  executionPlan: DecommissionExecutionPlan;
  dataMapping: DataMappingPlan;
  validationPlan: DecommissionValidationPlan;
  approvalWorkflow: DecommissionApprovalWorkflow;
}

// Core Strategy Types
export interface DecommissionStrategy {
  approach: DecommissionApproach;
  timeline: DecommissionTimeline;
  phases: DecommissionPhase[];
  dataStrategy: DataMigrationStrategy;
  cutoverStrategy: CutoverStrategy;
  riskMitigation: DecommissionRiskMitigation;
  rollbackStrategy: DecommissionRollbackStrategy;
}

export type DecommissionApproach =
  | 'big_bang' | 'phased' | 'parallel_run' | 'gradual_cutover' | 'pilot_rollout';

// Timeline Management
export interface DecommissionTimeline {
  plannedStart: string;
  plannedEnd: string;
  phases: PhaseTimeline[];
  milestones: DecommissionMilestone[];
  dependencies: TimelineDependency[];
  bufferTime: string;
  freezePeriods: FreezePeriod[];
}

export interface PhaseTimeline {
  phaseId: string;
  name: string;
  startDate: string;
  endDate: string;
  duration: string;
  prerequisites: string[];
  deliverables: string[];
  approvals: string[];
}

export interface DecommissionMilestone {
  id: string;
  name: string;
  date: string;
  type: 'planning' | 'approval' | 'cutover' | 'validation' | 'completion';
  criteria: string[];
  deliverables: string[];
  approvals: string[];
  risks: string[];
}

export interface TimelineDependency {
  id: string;
  predecessor: string;
  successor: string;
  type: 'finish_to_start' | 'start_to_start' | 'finish_to_finish' | 'start_to_finish';
  lag: string;
  constraint: string;
}

export interface FreezePeriod {
  name: string;
  startDate: string;
  endDate: string;
  description: string;
  restrictions: string[];
  exceptions: string[];
}

// Phase Management
export interface DecommissionPhase {
  id: string;
  name: string;
  description: string;
  type: 'preparation' | 'data_migration' | 'cutover' | 'validation' | 'cleanup';
  duration: string;
  activities: DecommissionActivity[];
  prerequisites: string[];
  deliverables: string[];
  risks: string[];
  rollbackTriggers: string[];
}

export interface DecommissionActivity {
  id: string;
  name: string;
  description: string;
  type: 'planning' | 'technical' | 'data' | 'testing' | 'approval' | 'communication';
  effort: string;
  resources: string[];
  dependencies: string[];
  deliverables: string[];
  validationCriteria: string[];
}

// Plan Data Types
export interface DecommissionPlanData {
  name: string;
  description: string;
  approach: DecommissionApproach;
  scope: DecommissionScope;
  strategy: DecommissionStrategy;
  timeline: DecommissionTimeline;
  resources: DecommissionResources;
  risks: DecommissionRisk[];
  compliance: ComplianceRequirement[];
  stakeholders: DecommissionStakeholder[];
  dependencies: DecommissionDependency[];
  approval: DecommissionApprovalRequirement[];
}

export interface DecommissionPlan extends DecommissionPlanData {
  id: string;
  planId: string;
  status: 'draft' | 'review' | 'approved' | 'executing' | 'completed' | 'cancelled';
  version: string;
  createdBy: string;
  createdAt: string;
  updatedAt: string;
  approvedAt?: string;
  approvedBy?: string;
}

// Resource Management
export interface DecommissionResources {
  team: TeamResource[];
  infrastructure: InfrastructureResource[];
  tools: ToolResource[];
  budget: BudgetResource;
}

export interface TeamResource {
  role: string;
  name: string;
  allocation: number;
  duration: string;
  skills: string[];
  availability: string;
}

export interface InfrastructureResource {
  type: string;
  description: string;
  quantity: number;
  duration: string;
  cost: number;
  availability: string;
}

export interface ToolResource {
  name: string;
  type: string;
  purpose: string;
  license: string;
  cost: number;
  training: boolean;
}

export interface BudgetResource {
  total: number;
  allocated: number;
  currency: string;
  breakdown: BudgetBreakdown[];
  contingency: number;
}

export interface BudgetBreakdown {
  category: string;
  amount: number;
  description: string;
  approval: string;
}

// Risk Management
export interface DecommissionRisk {
  id: string;
  name: string;
  description: string;
  category: 'technical' | 'business' | 'data' | 'compliance' | 'operational';
  likelihood: 'very_low' | 'low' | 'medium' | 'high' | 'very_high';
  impact: 'very_low' | 'low' | 'medium' | 'high' | 'very_high';
  riskLevel: 'low' | 'medium' | 'high' | 'critical';
  mitigation: DecommissionRiskMitigation;
  contingency: string;
  owner: string;
  status: 'open' | 'mitigating' | 'mitigated' | 'accepted' | 'closed';
}

export interface DecommissionRiskMitigation {
  strategy: string;
  actions: MitigationAction[];
  timeline: string;
  cost: number;
  effectiveness: number;
  monitoring: string[];
}

export interface MitigationAction {
  action: string;
  owner: string;
  dueDate: string;
  status: 'planned' | 'in_progress' | 'completed' | 'blocked';
  dependencies: string[];
}

export interface RiskMitigationStrategy {
  riskId: string;
  strategy: string;
  actions: string[];
  timeline: string;
  cost: number;
  effectiveness: number;
  owner: string;
  monitoring: string[];
  reporting: string;
}

// Compliance and Approval
export interface ComplianceRequirement {
  regulation: string;
  requirement: string;
  applicability: string[];
  actions: string[];
  validation: string[];
  evidence: string[];
  deadline: string;
  owner: string;
}

export interface DecommissionApprovalRequirement {
  type: 'plan' | 'execution' | 'data_disposal' | 'compliance' | 'business' | 'final';
  approver: string;
  criteria: string[];
  dependencies: string[];
  timeline: string;
  status: 'pending' | 'approved' | 'rejected' | 'conditional';
}

// Forward declarations for complex types from other modules
export interface DataHandlingStrategy { approach: string; }
export interface DataMigrationStrategy { approach: string; }
export interface CutoverStrategy { type: string; }
export interface DecommissionRollbackStrategy { capability: string; }
export interface DecommissionExecutionPlan { phases: unknown[]; }
export interface DataMappingPlan { mappings: unknown[]; }
export interface DecommissionValidationPlan { phases: unknown[]; }
export interface DecommissionApprovalWorkflow { steps: unknown[]; }
export interface DecommissionStakeholder { id: string; name: string; }
export interface DecommissionDependency { id: string; name: string; }
