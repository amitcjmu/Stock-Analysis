/**
 * Risk and Issue Management Types
 * 
 * Types for managing risks, issues, mitigation actions, and work logging
 * in engagement management.
 * 
 * Generated by CC (Claude Code) - Modularized from core-types.ts
 */

import type { User } from './team-management';

export type RiskSeverity = 'low' | 'medium' | 'high' | 'critical';
export type RiskStatus = 'open' | 'mitigating' | 'closed' | 'accepted';
export type IssuePriority = 'low' | 'medium' | 'high' | 'urgent';
export type IssueStatus = 'open' | 'in_progress' | 'resolved' | 'closed';

// Risk Management Types
export interface Risk {
  id: string;
  title: string;
  description: string;
  category: 'technical' | 'business' | 'resource' | 'schedule' | 'budget' | 'external';
  severity: RiskSeverity;
  probability: 'very_low' | 'low' | 'medium' | 'high' | 'very_high';
  impact: 'very_low' | 'low' | 'medium' | 'high' | 'very_high';
  riskScore: number; // Calculated from probability * impact
  status: RiskStatus;
  owner: User;
  identifiedBy: User;
  identifiedDate: string;
  mitigationPlan?: string;
  mitigationActions: RiskMitigationAction[];
  contingencyPlan?: string;
  reviewDate: string;
  lastReviewDate?: string;
  closedDate?: string;
  phaseId?: string;
  deliverableId?: string;
  tags: string[];
  createdAt: string;
  updatedAt: string;
}

export interface RiskMitigationAction {
  id: string;
  action: string;
  owner: User;
  dueDate: string;
  status: 'planned' | 'in_progress' | 'completed' | 'cancelled';
  completedDate?: string;
  effectiveness?: 'low' | 'medium' | 'high';
  cost?: number;
  comments?: string;
}

// Issue Management Types
export interface Issue {
  id: string;
  title: string;
  description: string;
  type: 'bug' | 'enhancement' | 'task' | 'question' | 'blocker' | 'change_request';
  priority: IssuePriority;
  severity: 'low' | 'medium' | 'high' | 'critical';
  status: IssueStatus;
  reporter: User;
  assignee: User;
  watchers: User[];
  reportedDate: string;
  assignedDate?: string;
  resolvedDate?: string;
  closedDate?: string;
  estimatedEffort?: number; // in hours
  actualEffort?: number; // in hours
  phaseId?: string;
  deliverableId?: string;
  milestoneId?: string;
  relatedIssues: string[];
  attachments: IssueAttachment[];
  comments: IssueComment[];
  workLog: IssueWorkLog[];
  labels: string[];
  customFields: Record<string, string | number | boolean | null>;
  createdAt: string;
  updatedAt: string;
}

export interface IssueAttachment {
  id: string;
  filename: string;
  size: number;
  mimeType: string;
  url: string;
  uploadedBy: User;
  uploadedAt: string;
}

export interface IssueComment {
  id: string;
  comment: string;
  author: User;
  isInternal: boolean;
  createdAt: string;
  updatedAt: string;
  editedBy?: User;
  reactions: CommentReaction[];
}

export interface CommentReaction {
  emoji: string;
  users: User[];
  count: number;
}

export interface IssueWorkLog {
  id: string;
  description: string;
  timeSpent: number; // in minutes
  dateWorked: string;
  worker: User;
  billable: boolean;
  createdAt: string;
}
