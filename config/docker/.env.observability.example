# Grafana Observability Stack Environment Variables
# Architecture: ADR-031
# Instructions:
#   1. Copy this file to .env.observability
#   2. Generate strong password: openssl rand -base64 32
#   3. Fill in all required values
#   4. NEVER commit .env.observability to git

# ============================================================================
# GRAFANA AUTHENTICATION (REQUIRED)
# ============================================================================
# Generate strong password (20+ chars):
# openssl rand -base64 32
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_GENERATE_WITH_OPENSSL

# ============================================================================
# AZURE AD INTEGRATION (OPTIONAL - Phase 2)
# ============================================================================
# Enable Azure AD authentication (if available within enterprise firewall)
AZURE_AD_ENABLED=false
AZURE_AD_CLIENT_ID=
AZURE_AD_CLIENT_SECRET=
AZURE_AD_AUTH_URL=https://login.microsoftonline.com/<tenant-id>/oauth2/v2.0/authorize
AZURE_AD_TOKEN_URL=https://login.microsoftonline.com/<tenant-id>/oauth2/v2.0/token

# ============================================================================
# HTTPS CONFIGURATION (PRODUCTION)
# ============================================================================
# For local dev: Use HTTP (default)
# For Azure/Railway: Use HTTPS (set protocol=https and configure SSL)

# Protocol (http or https)
GF_SERVER_PROTOCOL=http

# Root URL (public-facing URL)
GF_SERVER_ROOT_URL=http://localhost:9999

# Domain
GF_SERVER_DOMAIN=localhost

# SSL Certificate paths (only required if GF_SERVER_PROTOCOL=https)
# Place certificates in config/docker/observability/ssl/
GF_SERVER_CERT_FILE=/etc/grafana/ssl/grafana.crt
GF_SERVER_CERT_KEY=/etc/grafana/ssl/grafana.key

# For Azure Production (subdomain-based):
# GF_SERVER_PROTOCOL=https
# GF_SERVER_ROOT_URL=https://aiforceassessgrafana.cloudsmarthcl.com/
# GF_SERVER_DOMAIN=aiforceassessgrafana.cloudsmarthcl.com
# (TLS terminated at Azure Front Door/App Gateway)

# For Azure Production with External TLS Termination (RECOMMENDED):
# GF_SERVER_PROTOCOL=http  # Grafana receives HTTP from reverse proxy
# GF_SERVER_ROOT_URL=https://aiforceassessgrafana.cloudsmarthcl.com/  # Public URL is HTTPS

# ============================================================================
# GITHUB OAUTH (RAILWAY PROD ONLY)
# ============================================================================
# Enable GitHub OAuth for Railway production (enterprise firewall blocks this)
GF_AUTH_GITHUB_ENABLED=false
GF_AUTH_GITHUB_CLIENT_ID=
GF_AUTH_GITHUB_CLIENT_SECRET=
GF_AUTH_GITHUB_ALLOWED_ORGANIZATIONS=

# ============================================================================
# POSTGRESQL (REQUIRED FOR LLM/MFO DASHBOARDS)
# ============================================================================
# Use existing postgres password from main .env
POSTGRES_PASSWORD=postgres

# Read-only user for Grafana (create with migration script)
POSTGRES_GRAFANA_USER=grafana_readonly
POSTGRES_GRAFANA_PASSWORD=CHANGE_ME_GENERATE_WITH_OPENSSL

# ============================================================================
# RETENTION POLICIES
# ============================================================================
# Log retention (Loki)
LOKI_RETENTION_DAYS=14

# Trace retention (Tempo)
TEMPO_RETENTION_DAYS=7

# Metrics retention (Prometheus)
PROMETHEUS_RETENTION_DAYS=14

# ============================================================================
# ENVIRONMENT-SPECIFIC SETTINGS
# ============================================================================
# Environment: local | azure-dev | railway-prod
OBSERVABILITY_ENVIRONMENT=local

# ============================================================================
# OTEL INTEGRATION (PHASE 4 - OPTIONAL)
# ============================================================================
# Enable OpenTelemetry instrumentation in backend
OTEL_SDK_DISABLED=true  # Set to false in Phase 4
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp
OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://alloy:4318
OTEL_EXPORTER_OTLP_METRICS_ENDPOINT=http://alloy:4318

# ============================================================================
# SECURITY NOTES
# ============================================================================
# 1. Store GRAFANA_ADMIN_PASSWORD in Azure Key Vault (if available)
# 2. Rotate password every 90 days
# 3. Use strong passwords (20+ chars, mixed case, numbers, symbols)
# 4. NEVER commit this file to git
# 5. Add .env.observability to .gitignore
